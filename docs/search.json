[
  {
    "objectID": "lecture-04-joint-model.html",
    "href": "lecture-04-joint-model.html",
    "title": "Lecture 4: Joint model",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nUnderstand why joint models are needed when time-dependent covariates are internal\n\nDistinguish between extended Cox models and joint models\n\nDescribe the two components of a joint model:\n\na longitudinal submodel (e.g.¬†eGFR over time)\na time-to-event submodel (e.g.¬†graft failure)\n\nExplain how the longitudinal process is linked to the survival process\n\nInterpret key parameters from a joint model\nRecognise situations where joint models provide less biased and more realistic inference",
    "crumbs": [
      "Lectures",
      "Lecture 4: Joint model"
    ]
  },
  {
    "objectID": "lecture-04-joint-model.html#learning-objectives",
    "href": "lecture-04-joint-model.html#learning-objectives",
    "title": "Lecture 4: Joint model",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nUnderstand why joint models are needed when time-dependent covariates are internal\n\nDistinguish between extended Cox models and joint models\n\nDescribe the two components of a joint model:\n\na longitudinal submodel (e.g.¬†eGFR over time)\na time-to-event submodel (e.g.¬†graft failure)\n\nExplain how the longitudinal process is linked to the survival process\n\nInterpret key parameters from a joint model\nRecognise situations where joint models provide less biased and more realistic inference",
    "crumbs": [
      "Lectures",
      "Lecture 4: Joint model"
    ]
  },
  {
    "objectID": "lecture-04-joint-model.html#why-do-we-need-joint-models",
    "href": "lecture-04-joint-model.html#why-do-we-need-joint-models",
    "title": "Lecture 4: Joint model",
    "section": "2 Why Do We Need Joint Models?",
    "text": "2 Why Do We Need Joint Models?\nIn the extended Cox model, we allowed covariates to change over time. However, this approach relies on a key assumption:\n\nThe time-varying covariate is external\nIts evolution is not influenced by the underlying event process\n\nThis assumption is often unrealistic in medical and public health studies.\n\n\n\n\n\n\nThe Problem of Internal Time-Dependent Covariates\n\n\n\nA time-dependent covariate is internal if:\n\nIt is affected by the same disease process that leads to the event\nIt both predicts the event and is influenced by the event process\n\nA common example in transplantation studies is eGFR:\n\nDeclining eGFR increases the risk of graft failure\nAt the same time, eGFR declines because the graft is failing\n\n\n\n\n\n\n\n\n\nWarning\n\n\n\nWhen a time-dependent covariate is internal,\nthe extended Cox model may produce biased estimates.",
    "crumbs": [
      "Lectures",
      "Lecture 4: Joint model"
    ]
  },
  {
    "objectID": "lecture-04-joint-model.html#why-the-extended-cox-model-is-not-enough",
    "href": "lecture-04-joint-model.html#why-the-extended-cox-model-is-not-enough",
    "title": "Lecture 4: Joint model",
    "section": "3 Why the Extended Cox Model Is Not Enough",
    "text": "3 Why the Extended Cox Model Is Not Enough\nIn the extended Cox model:\n\nThe longitudinal process (e.g.¬†eGFR) is treated as error-free\nMeasurement error in repeated biomarker values is ignored\nThe feedback between the biomarker and the event is not modelled\n\nAs a result:\n\nThe estimated effect of the biomarker may be biased\nStandard errors may be underestimated\nInterpretation can be misleading\n\nü´ò Graft function declines\n‚¨áÔ∏è\nüß™ More clinical tests\n‚¨áÔ∏è\nüß´ Lower eGFR measurements\n‚¨áÔ∏è\n‚ö†Ô∏è Patient appears riskier\n‚¨áÔ∏è\nüìà Effect is exaggerated",
    "crumbs": [
      "Lectures",
      "Lecture 4: Joint model"
    ]
  },
  {
    "objectID": "lecture-04-joint-model.html#joint-models",
    "href": "lecture-04-joint-model.html#joint-models",
    "title": "Lecture 4: Joint model",
    "section": "4 Joint Models",
    "text": "4 Joint Models\nJoint models address these limitations by:\n\nModelling the longitudinal trajectory (e.g.¬†eGFR over time)\nModelling the time-to-event outcome (e.g.¬†graft failure)\nExplicitly linking the two processes\n\nThis allows us to:\n\nAccount for measurement error in the biomarker\nHandle internal time-dependent covariates\nObtain more realistic estimates of risk",
    "crumbs": [
      "Lectures",
      "Lecture 4: Joint model"
    ]
  },
  {
    "objectID": "lecture-04-joint-model.html#visual-demonestraion-of-longitudinal-process-egfr-and-survival-process-time-to-graft-lost",
    "href": "lecture-04-joint-model.html#visual-demonestraion-of-longitudinal-process-egfr-and-survival-process-time-to-graft-lost",
    "title": "Lecture 4: Joint model",
    "section": "5 Visual demonestraion of longitudinal process (eGFR) and survival process (time to graft lost)",
    "text": "5 Visual demonestraion of longitudinal process (eGFR) and survival process (time to graft lost)\nFigure 1: Individual and average eGFR trajectories after kidney transplantation\nThe left panel shows individual longitudinal eGFR trajectories for a subset of transplant recipients, illustrating substantial between-patient heterogeneity in both baseline kidney function and the rate of decline over time. Some patients experience relatively stable eGFR, while others show rapid deterioration, highlighting that kidney function evolves differently across individuals.\nThe right panel displays the average eGFR trajectory by donor type. On average, recipients of living-donor kidneys start with higher eGFR and maintain better kidney function over follow-up compared with recipients of deceased-donor kidneys. However, both groups show a general declining trend over time.\n\n\nShow R code\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(gridExtra)\n\n\ndat_long&lt;-read.csv(\"egfr_joint_data.CSV\")\n# sample 25 patients for visual clarity\nset.seed(20251113)\nids_sample &lt;- sample(unique(dat_long$id), 25)\n\np_traj &lt;- dat_long %&gt;%\n  filter(id %in% ids_sample) %&gt;%\n  ggplot(aes(x = time, y = egfr, group = id, colour = factor(id))) +\n  geom_line(size = 1.2, alpha = 0.85) +\n  geom_point(size = 2.2, alpha = 0.9) +\n  scale_colour_discrete(guide = \"none\") +  \n  labs(\n    x = \"Time since transplant (years)\",\n    y = \"eGFR (mL/min/1.73m¬≤)\",\n    title = \"Individual eGFR Trajectories (only for 25 ids)\"\n  ) +\n  theme_minimal(base_size = 10) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 8),\n    axis.title = element_text(face = \"bold\")\n  )\n\n\n\n\np_traj_by_donor &lt;- dat_long %&gt;%\n  group_by(donor_type, time) %&gt;%\n  summarise(mean_egfr = mean(egfr), .groups = \"drop\") %&gt;%\n  ggplot(aes(x = time, y = mean_egfr,\n             colour = factor(donor_type),\n             group = donor_type)) +\n  geom_line(size = 1.8) +\n  geom_point(size = 3) +\n  scale_colour_manual(\n    values = c(\"0\" = \"#0072B2\",    # deceased = blue\n               \"1\" = \"#D55E00\"),   # living = red\n    labels = c(\"0\" = \"Deceased donor\",\n               \"1\" = \"Living donor\")\n  ) +\n  labs(\n    x = \"Time since transplant (years)\",\n    y = \"Mean eGFR\",\n    colour = \"Donor type\",\n    title = \"Mean eGFR Trajectory by Donor Type\"\n  ) +\n  theme_minimal(base_size = 8) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 8),\n    axis.title = element_text(face = \"bold\")\n  )\n\n\n\n\n# Arrange side by side\ngrid.arrange(\n  p_traj,\n  p_traj_by_donor,\n  ncol = 2\n)\n\n\n\n\n\n\n\n\n\nFigure 2: Kaplan‚ÄìMeier curves for time to graft failure\nThe left panel shows the overall Kaplan‚ÄìMeier curve for time to graft failure, summarising graft survival for all transplant recipients combined. The stepwise nature of the curve reflects the occurrence of graft failure events over follow-up, while the shaded area represents the 95% confidence interval.\nThe right panel presents Kaplan‚ÄìMeier curves stratified by donor type. A clear separation between the curves is observed over time, indicating differences in graft survival between groups. Recipients of living-donor kidneys consistently show higher graft survival probabilities compared with recipients of deceased-donor kidneys throughout follow-up.\n\n\nShow R code\nlibrary(survival)\nlibrary(broom)\n\ndat_baseline&lt;-read.csv(\"egfr_wide_data.CSV\")\n\n\n# overall KM\nsurv_obj &lt;- Surv(time = dat_baseline$time, event = dat_baseline$status)\n\nfit_km &lt;- survfit(surv_obj ~ 1)\n\nkm_df &lt;- data.frame(\n  time  = fit_km$time,\n  surv  = fit_km$surv,\n  lower = fit_km$lower,\n  upper = fit_km$upper\n)\n\nKM1&lt;-ggplot(km_df, aes(x = time, y = surv)) +\n  geom_step(linewidth = 1.2, colour = \"#365abd\") +\n  geom_ribbon(aes(ymin = lower, ymax = upper),\n              alpha = 0.2,\n              fill = \"#365abd\") +\n  labs(\n    title = \"Kaplan‚ÄìMeier Curve for Time to Graft Failure\",\n    x = \"Time since transplant (years)\",\n    y = \"Graft survival probability\"\n  ) +\n  coord_cartesian(ylim = c(0, 1)) +\n  theme_grey(base_size = 8) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 8),\n    panel.grid.minor = element_blank()\n  )\n\n\n\n#KM curve by donor type\nfit_km_donor &lt;- survfit(Surv(time, status) ~ donor_type, data = dat_baseline)\n\nkm_df &lt;- tidy(fit_km_donor)\n\np_km &lt;- km_df %&gt;%\n  mutate(\n    donor_type = factor(strata,\n                        labels = c(\"Deceased donor\", \"Living donor\"))\n  ) %&gt;%\n  ggplot(aes(x = time, y = estimate,\n             colour = donor_type, fill = donor_type)) +\n  geom_step(size = 1.2) +\n  geom_ribbon(aes(ymin = conf.low, ymax = conf.high),\n              alpha = 0.20, colour = NA) +\n  scale_colour_manual(\n    values = c(\"Deceased donor\" = \"#0072B2\",\n               \"Living donor\"   = \"#D55E00\")\n  ) +\n  scale_fill_manual(\n    values = c(\"Deceased donor\" = \"#0072B2\",\n               \"Living donor\"   = \"#D55E00\")\n  ) +\n  labs(\n    x = \"Time since transplant (years)\",\n    y = \"Graft survival probability\",\n    colour = \"Donor type\",\n    fill = \"Donor type\",\n    title = \"Kaplan‚ÄìMeier Curves by Donor Type\"\n  ) +\n  theme_minimal(base_size = 8) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 8),\n    axis.title = element_text(face = \"bold\")\n  )\n\n\n\n\n\n# Arrange side by side\ngrid.arrange(\n  KM1,\n  p_km,\n  ncol = 2\n)\n\n\n\n\n\n\n\n\n\nImportantly, these plots illustrate that eGFR is a time-varying, patient-specific process that is closely linked to graft failure risk. Treating eGFR as a fixed baseline covariate or updating it naively in an extended Cox model may be inappropriate, as changes in eGFR can be driven by the underlying disease process itself. This motivates the use of joint models, which explicitly model the longitudinal eGFR process together with the time-to-event outcome.\n\n\n\n\n\n\nNote\n\n\n\nJoint models provide a unified framework for analysing\nlongitudinal measurements and time-to-event outcomes together.\n\nThey allow eGFR to be an internal time-varying covariate\n\nThey account for correlations between eGFR and risk of graft failure\n\nThey handle varying measurement times\n\nThey reduce bias caused by feedback loops\n\nThey improve prediction of graft loss",
    "crumbs": [
      "Lectures",
      "Lecture 4: Joint model"
    ]
  },
  {
    "objectID": "lecture-04-joint-model.html#joint-model-specification-linear-mixed-model-cox-model",
    "href": "lecture-04-joint-model.html#joint-model-specification-linear-mixed-model-cox-model",
    "title": "Lecture 4: Joint model",
    "section": "6 Joint Model Specification (Linear Mixed Model + Cox Model)",
    "text": "6 Joint Model Specification (Linear Mixed Model + Cox Model)\nA joint model links:\n\na longitudinal submodel for repeated measurements (e.g.¬†eGFR over time), and\n\na survival submodel for the time-to-event outcome (e.g.¬†graft failure),\n\nthrough a shared association structure.\nHere, we focus on a joint model combining a linear mixed-effects model and a Cox proportional hazards model.\nMore generally, the joint modelling framework is highly flexible and can be extended to:\n\na wide range of longitudinal models, including linear and non-linear mixed models, and\n\ndifferent types of survival models, including parametric and semi-parametric models.\n\nThe key idea is that the longitudinal and survival processes are modelled simultaneously and linked through shared subject-specific components.\n\n\n6.1 Longitudinal Submodel (Linear Mixed Effects Model)\nLet \\(y_i(t)\\) be the observed biomarker value (e.g.¬†eGFR) for individual \\(i\\) at time \\(t\\).\nWe model:\n\\[\ny_i(t) = m_i(t) + \\varepsilon_i(t),\n\\qquad \\varepsilon_i(t) \\sim N(0, \\sigma^2)\n\\]\nwhere \\(m_i(t)\\) is the true underlying (latent) biomarker trajectory.\nA common linear mixed model specification is:\n\\[\nm_i(t) = \\beta_0 + \\beta_1 t + \\beta_2^\\top X_i + b_{0i} + b_{1i} t\n\\]\n\n\\(\\beta_0, \\beta_1, \\beta_2\\) are fixed effects\n\\(X_i\\) are baseline covariates (e.g.¬†donor type, age, sex)\n\\(b_{0i}, b_{1i}\\) are random effects (subject-specific deviation)\n\nAssume the random effects follow:\n\\[\n\\begin{pmatrix}\nb_{0i}\\\\\nb_{1i}\n\\end{pmatrix}\n\\sim N\n\\left(\n\\begin{pmatrix}\n0\\\\\n0\n\\end{pmatrix},\nD\n\\right)\n\\]\n\n\n\n6.2 Survival Submodel (Cox Proportional Hazards Model)\nLet \\(T_i\\) be the event time and \\(h_i(t)\\) the hazard for individual \\(i\\) at time \\(t\\).\nThe Cox-type survival model is:\n\\[\nh_i(t \\mid \\mathcal{M}_i(t), Z_i) = h_0(t)\\exp\\left(\\gamma^\\top Z_i + \\alpha\\, f\\{m_i(t)\\}\\right)\n\\]\n\n\\(h_0(t)\\) is the baseline hazard\n\\(Z_i\\) are baseline covariates (can overlap with \\(X_i\\))\n\\(m_i(t)\\) is the latent true biomarker value from the longitudinal model\n\\(\\alpha\\) quantifies the association between the biomarker process and event risk\n\\(f\\{\\cdot\\}\\) defines how the longitudinal process enters the hazard\n\n\n\n\n6.3 The Link Between the Two Processes (Association Structures)\nThe most common choice is the current value association:\n\\[\nh_i(t) = h_0(t)\\exp\\left(\\gamma^\\top Z_i + \\alpha\\, m_i(t)\\right)\n\\]\nInterpretation of \\(\\alpha\\):\nFor a 1-unit higher true underlying biomarker value at time \\(t\\), the hazard changes by:\n\\[\nHR(t) = \\exp(\\alpha)\n\\]\n\n\n\n6.4 Alternative links\n(a) Current value + slope association\n\\[\nh_i(t) = h_0(t)\\exp\\left(\\gamma^\\top Z_i + \\alpha_1 m_i(t) + \\alpha_2 m_i'(t)\\right)\n\\]\nwhere \\(m_i'(t)\\) is the instantaneous rate of change (slope).\n(b) Cumulative (history) association\n\\[\nh_i(t) = h_0(t)\\exp\\left(\\gamma^\\top Z_i + \\alpha \\int_0^t m_i(s)\\,ds\\right)\n\\]\n\n\n\n\n\n\n\nWhy this helps\n\n\n\nUnlike the extended Cox model, the joint model:\n\ntreats the biomarker as a latent process \\(m_i(t)\\) rather than a noisy observed value \\(y_i(t)\\)\naccounts for measurement error\ncorrectly handles internal time-dependent covariates whose evolution is linked to event risk",
    "crumbs": [
      "Lectures",
      "Lecture 4: Joint model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html",
    "href": "lecture-02-cox-ph.html",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nUnderstand what the hazard represents\nFit a Cox proportional hazards (PH) model in R\nCheck the proportional hazards assumption\nInterpret hazard ratios (HRs)\nUnderstand when Cox and RMST answer different questions",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#learning-objectives",
    "href": "lecture-02-cox-ph.html#learning-objectives",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nUnderstand what the hazard represents\nFit a Cox proportional hazards (PH) model in R\nCheck the proportional hazards assumption\nInterpret hazard ratios (HRs)\nUnderstand when Cox and RMST answer different questions",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#survival-probability-vs-hazard",
    "href": "lecture-02-cox-ph.html#survival-probability-vs-hazard",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "2 Survival Probability vs Hazard",
    "text": "2 Survival Probability vs Hazard\n\nSurvival probability answers:\nWhat proportion of patients are still event-free by time \\(t\\)?\nHazard answers:\nHow quickly are events happening right now among those still at risk?\n\n\n\n\n\n\n\nNote\n\n\n\nSurvival is cumulative over time.\nHazard is instantaneous risk at a given moment.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#risk-and-hazard-at-time-t",
    "href": "lecture-02-cox-ph.html#risk-and-hazard-at-time-t",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "3 Risk and Hazard at Time \\(t\\)",
    "text": "3 Risk and Hazard at Time \\(t\\)\nWe follow people from a start point (e.g., transplant) until an event (e.g., graft failure) or censoring.\nRisk Set at Time \\(t\\)\nAt time \\(t\\), the risk set includes only individuals who:\n\nhave not yet experienced the event, and\nhave not been censored before time \\(t\\)\n\nThese are the only individuals who are considered at risk at time \\(t\\).\nHazard at Time \\(t\\)\nAmong individuals who are still event-free at time \\(t\\), the hazard describes:\n\nHow quickly events are occurring at that exact moment.\n\nFormally, the hazard function is defined as:\n\\[\nh(t) = \\lim_{\\Delta t \\to 0}\n\\frac{\\Pr(\\text{event in } [t, t+\\Delta t) \\mid \\text{survived to } t)}{\\Delta t}\n\\]\n\n\n\n\n\n\nNote\n\n\n\nThe hazard is a rate, not a probability.\nIt can be larger than 1 and does not represent the chance of failure by time \\(t\\).",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#from-hazard-to-short-term-risk",
    "href": "lecture-02-cox-ph.html#from-hazard-to-short-term-risk",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "4 From Hazard to Short-Term Risk",
    "text": "4 From Hazard to Short-Term Risk\nThe hazard describes how fast events are occurring at an instant, but it is not itself a probability.\nTo approximate the short-term risk of experiencing the event, we look at a small time window of length \\(\\Delta t\\).\nFor very small \\(\\Delta t\\), the probability of the event occurring shortly after time \\(t\\) is approximately:\n\\[\n\\Pr(\\text{event in the next } \\Delta t \\mid \\text{alive at } t)\n\\;\\approx\\;\nh(t) \\times \\Delta t\n\\]\n\n\n\n\n\n\nNote\n\n\n\nThis approximation helps link the hazard to a more intuitive concept of short-term risk. However, hazard itself is still a rate, not a probability.\n\n\n\n\n\n\n\n\nExample\n\n\n\n\nAt 12 months, 80 people are still at risk.\n\nBetween 12 and 13 months, 4 events occur.\n\nThe average monthly hazard over that interval ‚âà 4/80=0.05 per month.\n\nSo the risk during that month ‚âà 5% (because 0.05 √ó 1 month).",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#what-is-the-link-between-hazard-and-survival",
    "href": "lecture-02-cox-ph.html#what-is-the-link-between-hazard-and-survival",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "5 What Is the Link Between Hazard and Survival?",
    "text": "5 What Is the Link Between Hazard and Survival?\n- Cumulative Hazard\nThe cumulative hazard up to time \\(t\\) is the total hazard accumulated over time:\n\\[\nH(t) = \\int_0^t h(u)\\, du\n\\]\n- Survival Function\nThe survival probability at time \\(t\\) is related to the cumulative hazard by:\n\\[\nS(t) = \\exp\\{-H(t)\\}\n\\]\nThis means that survival depends on the entire history of the hazard, not just the hazard at a single time point.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#speedometer-and-odometer-analogy",
    "href": "lecture-02-cox-ph.html#speedometer-and-odometer-analogy",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "6 üöó Speedometer and Odometer Analogy",
    "text": "6 üöó Speedometer and Odometer Analogy\n\n\n\n\n\n\nNote\n\n\n\nThink of hazard as a speedometer and survival as an odometer.\n\n\nIf we know the speed at every moment, we can calculate the total distance travelled by adding up (integrating) the speed over time.\nSimilarly:\n\nIf we know the hazard at each moment,\n\nwe can calculate the cumulative hazard by integrating over time,\n\nand from the cumulative hazard we can determine the survival probability.\n\nSurvival tells us how far we have made it without experiencing the event since the starting point.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#what-does-the-cox-model-do",
    "href": "lecture-02-cox-ph.html#what-does-the-cox-model-do",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "7 What Does the Cox Model Do?",
    "text": "7 What Does the Cox Model Do?\nIn practice, individuals have different characteristics that may affect their risk of experiencing the event.\nThe Cox proportional hazards model describes how covariates change the hazard over time:\n\\[\nh(t \\mid X) = h_0(t)\\exp(\\beta_1 X_1 + \\beta_2 X_2 + \\cdots + \\beta_p X_p)\n\\]\nwhere:\n\n\\(h(t \\mid X)\\) is the hazard for an individual with covariates \\(X\\)\n\\(h_0(t)\\) is the baseline hazard (when all \\(X = 0\\))\n\\(\\beta\\) values describe how covariates affect the hazard\n\n\n\n\n\n\n\nNote\n\n\n\nThe Cox model does not require specifying the shape of \\(h_0(t)\\). It focuses on estimating relative differences in hazard between individuals.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#what-is-a-hazard-ratio",
    "href": "lecture-02-cox-ph.html#what-is-a-hazard-ratio",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "8 What Is a Hazard Ratio?",
    "text": "8 What Is a Hazard Ratio?\nFor a one-unit increase in a covariate \\(X_j\\), the hazard ratio is:\n\\[\nHR = \\exp(\\beta_j)\n\\]\nThis represents the ratio of hazards between two individuals who differ by one unit in \\(X_j\\),\nholding all other covariates constant.\n\n\n\n\n\n\nInterpretation\n\n\n\n\n\\(HR = 1\\): no difference in hazard\n\n\\(HR &lt; 1\\): lower hazard (protective effect)\n\n\\(HR &gt; 1\\): higher hazard (increased risk)",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#cox-ph-model-assumptions",
    "href": "lecture-02-cox-ph.html#cox-ph-model-assumptions",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "9 Cox PH model assumptions",
    "text": "9 Cox PH model assumptions\n1. Proportional Hazards (PH)\nThe hazard ratio between groups is constant over time. Example: If \\(HR = 0.6\\) at 1 year, it should also be 0.6 at 5 years.\n2. Linearity of Continuous Covariates\nContinuous variables (e.g., age, eGFR) affect the log hazard in a linear way. If not, we may need transformations or splines.\n3. Independent Censoring\nCensoring (loss to follow-up, end of study) is unrelated to the future risk of the event.\n4. Correct Model Specification\nAll important predictors are included, and no important variables are mis-specified.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#example-kidney-transplant-study",
    "href": "lecture-02-cox-ph.html#example-kidney-transplant-study",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "10 Example: Kidney Transplant Study",
    "text": "10 Example: Kidney Transplant Study\nWe are interested in whether donor type (living vs deceased) is associated with the hazard of graft failure over time, after adjusting for donor age, recipient sex, and baseline eGFR at the time of transplant.\nOutcome\n- Time to graft failure (months since transplant)\nEvent Indicator: Graft failure status\n- 1 = failure\n- 0 = censored\nMain Exposure\n- Donor type (Living vs Deceased)\nCovariates\n- Donor age (years)\n- Recipient sex (male / female)\n- eGFR at transplant\n\n\n\n\n\n\nNote\n\n\n\nWe use simulated transplant data for illustration.\n\n\n\n\nShow R code\nlibrary(survival)\nlibrary(dplyr)\n\ndf &lt;- read.csv(\"simulated_data.csv\")\n\ndf$recipient_sex &lt;- factor(df$recipient_sex, levels = c(\"Male\", \"Female\"))\ndf$donor_type &lt;- factor(df$donor_type, levels = c(\"Deceased\", \"Living\"))\n\nhead(df)\n\n\n  id  time status donor_type donor_age recipient_sex egfr_at_tx\n1  1  41.6      0     Living        32          Male       34.9\n2  2  38.7      0   Deceased        64        Female       12.6\n3  3   0.9      0   Deceased        64          Male       45.5\n4  4  13.3      0   Deceased        44          Male       41.0\n5  5 131.9      1     Living        59          Male       31.1\n6  6  14.5      0     Living        37          Male       31.5",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#fit-the-cox-model",
    "href": "lecture-02-cox-ph.html#fit-the-cox-model",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "11 Fit the Cox Model",
    "text": "11 Fit the Cox Model\n\n\nShow R code\ncox_model &lt;- coxph(\nSurv(time, status) ~ donor_type + donor_age + recipient_sex + egfr_at_tx,\ndata = df\n)\n\nsummary(cox_model)\n\n\nCall:\ncoxph(formula = Surv(time, status) ~ donor_type + donor_age + \n    recipient_sex + egfr_at_tx, data = df)\n\n  n= 1000, number of events= 470 \n\n                         coef exp(coef)  se(coef)      z Pr(&gt;|z|)    \ndonor_typeLiving    -0.603679  0.546796  0.117873 -5.121 3.03e-07 ***\ndonor_age            0.020758  1.020975  0.004604  4.509 6.52e-06 ***\nrecipient_sexFemale  0.060762  1.062646  0.093337  0.651    0.515    \negfr_at_tx          -0.026328  0.974015  0.003046 -8.645  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                    exp(coef) exp(-coef) lower .95 upper .95\ndonor_typeLiving       0.5468     1.8288    0.4340    0.6889\ndonor_age              1.0210     0.9795    1.0118    1.0302\nrecipient_sexFemale    1.0626     0.9410    0.8850    1.2760\negfr_at_tx             0.9740     1.0267    0.9682    0.9798\n\nConcordance= 0.661  (se = 0.013 )\nLikelihood ratio test= 160.2  on 4 df,   p=&lt;2e-16\nWald test            = 151.8  on 4 df,   p=&lt;2e-16\nScore (logrank) test = 156.1  on 4 df,   p=&lt;2e-16",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#checking-model-assumptions",
    "href": "lecture-02-cox-ph.html#checking-model-assumptions",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "12 Checking Model Assumptions",
    "text": "12 Checking Model Assumptions\n1. Proportional Hazards (PH) Assumption\nThe Cox model assumes that hazard ratios are constant over time.\nWe assess this using Schoenfeld residuals.\n\n\nShow R code\nph_test &lt;- cox.zph(cox_model)\nph_test\n\n\n               chisq df     p\ndonor_type    4.4452  1 0.035\ndonor_age     2.9643  1 0.085\nrecipient_sex 0.0295  1 0.864\negfr_at_tx    2.1768  1 0.140\nGLOBAL        6.2504  4 0.181\n\n\nShow R code\nplot(ph_test)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nIf the global test is not significant, the PH assumption is reasonable.\n\n\n2. Linearity of Continuous Covariates\nThe Cox model assumes that continuous covariates have a linear effect on the log-hazard.\nIf this assumption is violated, the model may be misspecified.\nA common diagnostic is to plot Martingale residuals against each continuous covariate:\n\n\nShow R code\nmart_resid &lt;- residuals(cox_model, type = \"martingale\")\n\n# Plot residuals vs continuous covariates\n\n\nplot(df$donor_age, mart_resid,\n     xlab = \"Donor age (years)\", ylab = \"Martingale residuals\",\n     main = \"Linearity check: Donor age\")\nlines(lowess(df$donor_age, mart_resid), lwd = 2)\n\n\n\n\n\n\n\n\n\nShow R code\nplot(df$egfr_at_tx, mart_resid,\n     xlab = \"eGFR at transplant\", ylab = \"Martingale residuals\",\n     main = \"Linearity check: eGFR\")\nlines(lowess(df$egfr_at_tx, mart_resid), lwd = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nIf the linearity assumption holds, the scatter of residuals should look randomly spread around zero with no strong curvature.\nIf you see a systematic curve/trend, that suggests non-linearity, and you might need transformations (e.g.¬†log, quadratic, splines).",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#model-interpretation",
    "href": "lecture-02-cox-ph.html#model-interpretation",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "13 Model Interpretation",
    "text": "13 Model Interpretation\n-Donor type:\nRecipients of living donor kidneys had a 45% lower hazard of graft failure compared with those who received deceased donor kidneys (HR = 0.55, 95% CI: 0.43‚Äì0.69, p &lt; 0.001).\n-Donor age:\nEach additional year of donor age was associated with a 2% increase in hazard of graft failure (HR = 1.02, 95% CI: 1.01‚Äì1.03, p &lt; 0.001).\nHow to improve the reporting HR for donor age?\nDonor age: Each 10-year increase in donor age was associated with a 22% increase in the hazard of graft failure (HR = 1.22, 95% CI: 1.13‚Äì1.34, p &lt; 0.001).\n-Recipient sex:\nThere was no evidence of an association between recipient sex and graft failure (HR = 1.06, 95% CI: 0.89‚Äì1.28, p = 0.52).\n-eGFR at transplant:\nHigher baseline eGFR was strongly protective: each 1-unit increase was associated with a 3% lower hazard of graft failure (HR = 0.97, 95% CI: 0.97‚Äì0.98, p &lt; 0.001).\n\n\n\n\n\n\nConnection to RMST\n\n\n\nIf hazards are not proportional:\nHazard ratios may be misleading\nRMST provides an absolute, time-based summary\nRMST does not rely on the PH assumption\nThis motivates using RMST as an alternative or complement to Cox models.\n\n\n\nüß† Think about the following before moving on:\nWhat should we do if the proportional hazards assumption is violated?\nHow could we model time-varying effects?\nWhen would RMST be preferable to the Cox proportional hazards model?",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Advanced Survival Concepts and Analysis",
    "section": "",
    "text": "Welcome!\nThis workshop covers a series of lectures on survival analysis.\nWe begin with an introduction to survival data and basic survival analysis, followed by the Cox proportional hazards model. We then explore extensions of the Cox model when the proportional hazards assumption is violated, as well as joint models and nonlinear Cox models.\nAll lectures are prepared by Dr Farzaneh Boroumand (Farzaneh.Boroumand@sydney.edu.au).\nThe datasets used in this workshop are simulated datasets, created solely for educational purposes.\n\n\n\n\n\n\nHow to use this website\n\n\n\n\nClick Lecture 1‚Äì5 in the sidebar.\nEach lecture contains:\n\nexplanation\nR code (collapsible)\noutputs\ninterpretation",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n\nShow R code\n1 + 1\n\n\n[1] 2"
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html",
    "href": "lecture-01-intro-km-rmst.html",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nDescribe what makes survival data different from standard outcomes\nExplain how Kaplan‚ÄìMeier survival curves are constructed\nInterpret censoring in survival analysis\nIdentify the limitations of Kaplan‚ÄìMeier curves\nUnderstand the motivation for Restricted Mean Survival Time (RMST)\nInterpret RMST differences and ratios in applied settings",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#learning-objectives",
    "href": "lecture-01-intro-km-rmst.html#learning-objectives",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nDescribe what makes survival data different from standard outcomes\nExplain how Kaplan‚ÄìMeier survival curves are constructed\nInterpret censoring in survival analysis\nIdentify the limitations of Kaplan‚ÄìMeier curves\nUnderstand the motivation for Restricted Mean Survival Time (RMST)\nInterpret RMST differences and ratios in applied settings",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#what-is-survival-data",
    "href": "lecture-01-intro-km-rmst.html#what-is-survival-data",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "2 What is survival data?",
    "text": "2 What is survival data?\nSurvival data measure the time until a specific event occurs.\nExamples in kidney research include:\n- Time from transplantation to graft failure\n- Time from transplant to patient death\n- Time to acute rejection\n\n\n\n\n\n\nKey feature of survival data\n\n\n\nThe outcome is composite: - a time variable - an event indicator\n(1 = event occurred, 0 = censored)\nThese two components must always be analysed together.",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#kaplanmeier-survival-curves",
    "href": "lecture-01-intro-km-rmst.html#kaplanmeier-survival-curves",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "3 Kaplan‚ÄìMeier survival curves",
    "text": "3 Kaplan‚ÄìMeier survival curves\nA Kaplan‚ÄìMeier (KM) curve estimates the probability of remaining event-free beyond a given time.\nThe KM method is a non-parametric approach used to estimate the survival function.\n\nIt estimates the probability of surviving beyond a given time.\nIt appropriately handles censoring, where some individuals have not experienced the event by the end of follow-up.\n\nThe Kaplan‚ÄìMeier estimator at time \\(t_i\\) is defined as:\n\\[\n\\hat{S}(t_i) = \\hat{S}(t_{i-1}) \\times \\left( 1 - \\frac{d_i}{r_i} \\right)\n\\]\nwhere:\n\n\\(d_i\\) is the number of events occurring at time \\(t_i\\)\n\\(r_i\\) is the number of individuals at risk just before time \\(t_i\\)\n\n\n\n\n\n\n\nHow to read a Kaplan‚ÄìMeier curve\n\n\n\n\nThe curve decreases in steps, not smoothly\nEach drop corresponds to an event time\nFlat sections indicate no events\nCensored observations:\n\ndo not cause the curve to drop\nreduce the number at risk going forward",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#example-simple-kaplanmeier-estimate",
    "href": "lecture-01-intro-km-rmst.html#example-simple-kaplanmeier-estimate",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "4 Example: simple Kaplan‚ÄìMeier estimate",
    "text": "4 Example: simple Kaplan‚ÄìMeier estimate\nThis dataset captures the time from kidney transplantation to graft failure. The only predictor variable included is donor type.\n\n\n\nID\nGraft failure\nTime to graft failure (months)\nDonor type\n\n\n\n\n1\n1\n3\nLiving\n\n\n2\n0\n5\nDeceased\n\n\n3\n1\n6\nLiving\n\n\n4\n1\n8\nDeceased\n\n\n5\n0\n10\nLiving\n\n\n6\n1\n12\nDeceased\n\n\n\nThe KM estimates can be written as follows:\n\n\n\n\n\n\n\n\n\nSorted time\nGraft failure\nNumber of people at risk\nSurvival probability\n\n\n\n\n0\n‚Äì\n6\n1.000\n\n\n3\n1\n6\n1 √ó (1 ‚àí 1/6) = 0.833\n\n\n6\n1\n4\n0.833 √ó (1 ‚àí 1/4) = 0.625\n\n\n8\n1\n3\n0.625 √ó (1 ‚àí 1/3) = 0.417\n\n\n12\n1\n2\n0.417 √ó (1 ‚àí 1/1) = 0\n\n\n\n\n\nShow R code\nlibrary(survival)\nlibrary(survminer)\n\ndf &lt;- data.frame(\n  id = 1:6,\n  time = c(3, 5, 6, 8, 10, 12),\n  status = c(1, 0, 1, 1, 0, 1)\n)\n\nkm_fit &lt;- survfit(Surv(time, status) ~ 1, data = df)\n\nggsurvplot(\n  km_fit,\n  data = df,\n  censor = TRUE,\n  risk.table = TRUE,\n  xlab = \"Time from transplant (months)\",\n  ylab = \"Survival probability\",\n  ggtheme = theme_minimal()\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInterpretation\n\n\n\nAt any given time point, the survival probability represents the estimated proportion of individuals who remain event-free beyond that time.\nCensored individuals:\n- contribute information up to their censoring time\n- do not count as failures\n- do not cause drops in the curve",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#kaplanmeier-curves-by-donor-type",
    "href": "lecture-01-intro-km-rmst.html#kaplanmeier-curves-by-donor-type",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "5 Kaplan‚ÄìMeier curves by donor type",
    "text": "5 Kaplan‚ÄìMeier curves by donor type\nThe simulated data contains the time from kidney transplantation to graft failure. The only predictor variable included is donor type.\n\n\nShow R code\nset.seed(2025)\n\nn &lt;- 200\ndonor_type &lt;- sample(c(\"Living\", \"Deceased\"), n, replace = TRUE)\n\ntime &lt;- ifelse(donor_type == \"Living\",\n               rexp(n, rate = 0.05),\n               rexp(n, rate = 0.1))\n\ncensoring_time &lt;- rexp(n, rate = 0.05)\nobserved_time &lt;- pmin(time, censoring_time)\nstatus &lt;- as.integer(time &lt;= censoring_time)\n\ndf &lt;- data.frame(\n  time = round(observed_time, 1),\n  status = status,\n  donor_type = donor_type\n)\n\nkm_fit &lt;- survfit(Surv(time, status) ~ donor_type, data = df)\n\nggsurvplot(\n  km_fit,\n  data = df,\n  risk.table = TRUE,\n  pval = TRUE,\n  conf.int = TRUE,\n  legend.title = \"Donor type\",\n  xlab = \"Time to graft failure (months)\",\n  ylab = \"Survival probability\",\n  ggtheme = theme_minimal()\n)",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#limitation-of-kaplanmeier-curves",
    "href": "lecture-01-intro-km-rmst.html#limitation-of-kaplanmeier-curves",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "6 Limitation of Kaplan‚ÄìMeier curves",
    "text": "6 Limitation of Kaplan‚ÄìMeier curves\n\n\n\n\n\n\nWarning\n\n\n\nKaplan‚ÄìMeier curves allow group comparison only.\nThey cannot:\n- adjust for confounders\n- include continuous predictors\nFor adjusted analyses, we need regression-based approaches, such as Cox regression or RMST regression.",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#restricted-mean-survival-time-rmst",
    "href": "lecture-01-intro-km-rmst.html#restricted-mean-survival-time-rmst",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "7 Restricted Mean Survival Time (RMST)",
    "text": "7 Restricted Mean Survival Time (RMST)\nSo far, we‚Äôve seen that Kaplan-Meier does not adjust for confounders. To handle covariates, we need approaches like:\n- Cox regression\n- RMST regression\n- Parametric survival models\nIn censored data, the true mean survival time is often not observable. We don‚Äôt have event time for some of the individual they may not experience the event.\nBecause of censoring, estimating the unrestricted mean survival time is often not feasible. Instead, we define a fixed time point \\(ùùâ\\) and focus on Restricted Mean Survival Time (RMST):\nThe average time survived up to time \\(ùùâ\\).\n\n\n\n\n\n\nNote\n\n\n\nRMST is the average time survived up to a fixed time point œÑ.\nIt answers the question:\n\n‚ÄúHow long, on average, do individuals remain event-free within œÑ months?‚Äù\n\n\n\n\n\n\n\n\n\nWhy RMST is attractive\n\n\n\n\nDirectly interpretable\nDoes not require proportional hazards\nWorks well when survival curves cross\n\n\n\n\n\nShow R code\nlibrary(ggplot2)\n\n# Parameters\ntau &lt;- 5\nrate &lt;- 0.2\ntmax &lt;- 10\n\n\n# Example survival curve\n# S(t) = exp(-rate * t)\n\nsurv_df &lt;- data.frame(time = seq(0, tmax, by = 0.01))\nsurv_df$S &lt;- exp(-rate * surv_df$time)\n\n# Area under curve up to tau (RMST region)\nsurv_df_shade &lt;- subset(surv_df, time &lt;= tau)\n\n\n# Plot\nggplot(surv_df, aes(x = time, y = S)) +\n  geom_area(\n    data = surv_df_shade,\n    aes(x = time, y = S),\n    fill = \"skyblue\",\n    alpha = 0.35\n  ) +\n  geom_line(\n    linewidth = 1.2,\n    colour = \"blue\"\n  ) +\n  geom_vline(\n    xintercept = tau,\n    linetype = \"dashed\",\n    colour = \"red\",\n    linewidth = 0.9\n  ) +\n  annotate(\n    \"text\",\n    x = tau + 0.15,\n    y = 0.5,\n    label = paste0(\"Tau = \", tau),\n    colour = \"red\",\n    size = 5,\n    hjust = 0\n  ) +\n  labs(\n    x = \"Time\",\n    y = \"Survival Probability\"\n  ) +\n  coord_cartesian(xlim = c(0, tmax), ylim = c(0, 1)) +\n  theme_minimal(base_size = 14)",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#adjusted-rmst-regression-in-kidney-transplant-patients",
    "href": "lecture-01-intro-km-rmst.html#adjusted-rmst-regression-in-kidney-transplant-patients",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "8 Adjusted RMST regression in Kidney Transplant Patients",
    "text": "8 Adjusted RMST regression in Kidney Transplant Patients\nWe aim to estimate the restricted mean survival time (RMST) up to \\(\\tau = 36\\) months after kidney transplantation, and to compare outcomes between donor types while adjusting for important clinical factors.\nOutcome\n- Time to graft failure (months since transplantation)\nEvent Indicator\n- Graft failure status - 1 = graft failure occurred\n- 0 = censored (no failure by end of follow-up)\nMain Exposure\n- Donor type - Living donor\n- Deceased donor\nCovariates (Adjusted For)\nTo reduce confounding, we adjust for:\n- Donor age (years)\n- Recipient gender (male / female)\n- Baseline eGFR at transplant (kidney function at time of surgery)\nInterpretation Goal\nAfter adjustment, the RMST contrast represents:\n\nThe average difference in graft-survival time up to \\(36\\) months between living and deceased donor transplants,\namong patients with similar donor age, recipient gender, and baseline eGFR.\n\n\n\nShow R code\nlibrary(survival)\nlibrary(survRM2)\nlibrary(survminer)\nlibrary(dplyr)\n\n\n# -------------------- Simulate the dataset\n\nset.seed(2025)\nn &lt;- 1000\n\n# Donor type\ndonor_type &lt;- sample(c(\"Living\", \"Deceased\"), size = n, replace = TRUE)\n\n# Donor age (older for deceased donors)\ndonor_age &lt;- ifelse(donor_type == \"Living\",\n                    rnorm(n, mean = 45, sd = 10),\n                    rnorm(n, mean = 60, sd = 10))\ndonor_age &lt;- round(pmax(donor_age, 18))\n\n# Recipient sex\nrecipient_sex &lt;- sample(c(\"Male\", \"Female\"), size = n, replace = TRUE)\n\n# eGFR at transplant\negfr_at_tx &lt;- round(runif(n, min = 5, max = 60), 1)\n\n# Simulated survival times (longer for living donors)\ntime &lt;- ifelse(donor_type == \"Living\",\n               rexp(n, rate = 0.05),  # mean ~20\n               rexp(n, rate = 0.1))   # mean ~10\n\n# Censoring\ncensoring_time &lt;- rexp(n, rate = 0.05)\n#observed_time &lt;- pmin(time, censoring_time)\nobserved_time &lt;- pmax(pmin(time, censoring_time), 0.01)\nstatus &lt;- as.integer(time &lt;= censoring_time)\n\n# Create dataset\ndf &lt;- data.frame(\n  id = 1:n,\n  time = round(observed_time, 1),\n  status = status,\n  donor_type = donor_type,\n  donor_age = donor_age,\n  recipient_sex = recipient_sex,\n  egfr_at_tx = egfr_at_tx\n)\n\n# Encode donor_type as binary: 1 = Living, 0 = Deceased\ndf$donor_type_bin &lt;- ifelse(df$donor_type == \"Living\", 1, 0)\n\n\n#----------------- Fit RMST Regression (with covariates)\n\n# Set truncation time œÑ (e.g., 36 months)\ntau &lt;- 36\n\ndf$recipient_sex &lt;- as.factor(df$recipient_sex)\ndf$donor_type_bin &lt;- ifelse(df$donor_type == \"Living\", 1, 0)\ndf$time[df$time == 0] &lt;- 0.01\ncovariates &lt;- model.matrix(~ donor_age + recipient_sex + egfr_at_tx, data = df)[, -1]\n\n\n# Fit RMST regression model\nrmst_model &lt;- rmst2(time = df$time,\n                    status = df$status,\n                    arm = df$donor_type_bin,\n                    tau = 36,\n                    covariates = covariates\n                    )\n\nrmst_model\n\n\n\nThe truncation time: tau = 36  was specified. \n\nSummary of between-group contrast (adjusted for the covariates) \n                      Est. lower .95 upper .95 p\nRMST (arm=1)-(arm=0) 6.298     3.914     8.681 0\nRMST (arm=1)/(arm=0) 1.690     1.391     2.054 0\nRMTL (arm=1)/(arm=0) 0.766     0.691     0.850 0\n\n\nModel summary (difference of RMST) \n                    coef se(coef)      z     p lower .95 upper .95\nintercept          7.102    3.909  1.817 0.069    -0.559    14.763\narm                6.298    1.216  5.179 0.000     3.914     8.681\ndonor_age          0.016    0.055  0.295 0.768    -0.092     0.124\nrecipient_sexMale -0.748    1.230 -0.608 0.543    -3.158     1.663\negfr_at_tx         0.047    0.041  1.150 0.250    -0.033     0.127\n\n\nModel summary (ratio of RMST) \n                    coef se(coef)      z     p exp(coef) lower .95 upper .95\nintercept          2.042    0.325  6.280 0.000     7.705     4.074    14.571\narm                0.525    0.099  5.281 0.000     1.690     1.391     2.054\ndonor_age          0.001    0.005  0.310 0.756     1.001     0.993     1.010\nrecipient_sexMale -0.063    0.102 -0.617 0.537     0.939     0.769     1.146\negfr_at_tx         0.004    0.003  1.159 0.246     1.004     0.997     1.011\n\n\nModel summary (ratio of time-lost) \n                    coef se(coef)      z     p exp(coef) lower .95 upper .95\nintercept          3.375    0.163 20.686 0.000    29.224    21.226    40.237\narm               -0.266    0.053 -5.022 0.000     0.766     0.691     0.850\ndonor_age         -0.001    0.002 -0.288 0.773     0.999     0.995     1.004\nrecipient_sexMale  0.031    0.051  0.603 0.546     1.032     0.933     1.141\negfr_at_tx        -0.002    0.002 -1.144 0.252     0.998     0.995     1.001\n\n\n\n\n\n\n\n\nInterpretation (RMST difference)\n\n\n\nRMST (Living donor - Deceased donor) = 6.30 months95% CI: 3.91 to 8.68, p &lt; 0.001 Interpretation: On average, recipients of living donor kidneys survive 6.3 more months event-free (up to 36 months) than those with deceased donors, after adjusting for age, sex, and eGFR at transplant.\n\n\n\n\n\n\n\n\nInterpretation (RMST ratio)\n\n\n\nRMST ratio = 1.69 (Living vs Deceased) 95% CI: 1.39 to 2.05, p &lt; 0.001 Over the 36-month period, recipients of living donor kidneys have 69% longer average event-free survival time than recipients of deceased donor kidneys, after adjustment.\n\n\n\n\n\n\n\n\nInterpretation (Covariate coefficients)\n\n\n\nNone of the covariates were significant in our simulated data but if for an example egfr was significant then the interpretation would be:\nEach unit increase in eGFR at the time of transplant is associated with an additional 0.047(coefficient in the model ) months (‚âà3 days) of average event-free survival time over 36 months, adjusting for donor type, donor age, and recipient sex.\n\n\n\nüß† Think about the following before moving on:\n\nWhy do we need to choose a truncation time \\(œÑ\\)?\nWhat happens if œÑ is too short or too long?\nWhen would RMST be preferable to a Cox model?",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html",
    "href": "lecture-03-non-ph-cox.html",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nRecognise when the proportional hazards (PH) assumption is violated\nUnderstand different strategies to handle non-PH:\n\nStratified Cox model\nTime-varying effects\nExtended Cox with time-varying covariates\n\nUnderstand when a joint model is needed",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#learning-objectives",
    "href": "lecture-03-non-ph-cox.html#learning-objectives",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nRecognise when the proportional hazards (PH) assumption is violated\nUnderstand different strategies to handle non-PH:\n\nStratified Cox model\nTime-varying effects\nExtended Cox with time-varying covariates\n\nUnderstand when a joint model is needed",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#reminder-proportional-hazards-assumption",
    "href": "lecture-03-non-ph-cox.html#reminder-proportional-hazards-assumption",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "2 Reminder: Proportional Hazards Assumption",
    "text": "2 Reminder: Proportional Hazards Assumption\nThe Cox model assumes that hazard ratios are constant over time.\nThis means that if one group has higher risk than another at the beginning, it has the same relative risk later in follow-up.\n\n\n\n\n\n\nNote\n\n\n\nIf this assumption does not hold, the estimated hazard ratio from a standard Cox model may be misleading.",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#what-if-proportional-hazards-does-not-hold",
    "href": "lecture-03-non-ph-cox.html#what-if-proportional-hazards-does-not-hold",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "3 What If Proportional Hazards Does Not Hold?",
    "text": "3 What If Proportional Hazards Does Not Hold?\nThere are several approaches when PH is violated:\n\nStratified Cox model: allow baseline hazards to differ by group.\nInclude time-varying effect: model changing effects over time, include interaction between covariate and time (e.g.¬†\\(ùë•√óùë°\\)).\nUse extended Cox model: allow a covariate‚Äôs value itself to change over time.",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#stratified-cox-model",
    "href": "lecture-03-non-ph-cox.html#stratified-cox-model",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "4 Stratified Cox model",
    "text": "4 Stratified Cox model\nWhen the proportional hazards (PH) assumption is violated for a categorical variable, one option is a stratified Cox model.\nA stratified Cox model can be written as:\n\\[\nh_s(t \\mid X) = h_{0s}(t)\\,\\exp(\\beta_1 X_1 + \\beta_2 X_2 + \\cdots)\n\\]\nwhere:\n\n\\(s\\) is the stratum (e.g.¬†donor type)\n\\(h_{0s}(t)\\) is the baseline hazard for stratum \\(s\\)\n\\(X_1, X_2, \\ldots\\) are other covariates\n\nWhat does stratification mean?\nIf we stratify on a variable (e.g.¬†donor type):\n\nWe do not estimate a single hazard ratio for the stratifying variable anymore\n(we are not saying ‚Äúliving vs deceased = HR 0.7‚Äù)\nThe stratifying variable is used only to define strata\nEach stratum is allowed to have a different baseline risk trajectory over time\n\nIn words:\n\nPatients with living donors and patients with deceased donors are allowed to have completely different baseline hazards over time.\n\nWhat is still estimated?\nWe still estimate the effects of other covariates (e.g.¬†donor age, recipient sex, eGFR at transplant), assuming those effects are proportional within each stratum.\n\n\n\n\n\n\nNote\n\n\n\nStratification is useful when a variable strongly affects baseline risk but does not satisfy the PH assumption.\n\n\nStratification can be thought of as:\n\n‚ÄúParallel Cox models with different baseline hazards, but the same slopes for the other covariates.‚Äù\n\nThat is, each group has its own baseline risk over time, but covariate effects are assumed to be the same across groups.\n\n\n\n\n\n\nWhen to Use It\n\n\n\n‚úÖ When to use stratification Use stratification when:\n\nThe proportional hazards (PH) violation is mainly driven by one categorical variable (e.g.¬†donor type)\nYou still want to adjust for this variable\nBut you do not need its hazard ratio as a main result\n\nIn this case, the variable is used to define strata rather than being estimated as a coefficient.\n‚ùå When not to use stratification Do not use stratification when:\n\nThe stratifying variable is your primary exposure of interest\nYou need to report a hazard ratio comparing groups\n\nBecause once you stratify on a variable (e.g.¬†donor type), you no longer obtain a single hazard ratio comparing those groups.",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#example-handling-non-proportional-hazards-using-stratified-cox-model",
    "href": "lecture-03-non-ph-cox.html#example-handling-non-proportional-hazards-using-stratified-cox-model",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "5 Example: Handling Non-Proportional Hazards Using Stratified Cox Model",
    "text": "5 Example: Handling Non-Proportional Hazards Using Stratified Cox Model\nWe are interested in whether time to graft failure after kidney transplantation differs by donor type (living vs deceased), after adjusting for important clinical factors.\nWe begin by fitting a standard Cox proportional hazards model, then check the PH assumption. If the PH assumption is violated for any categorical covariate in the model, we refit the model using stratification by that covariate.\n\n\nShow R code\nlibrary(survival)\n\nstratified_kidney_data&lt;-read.csv(\"stratified_kidney_data.CSV\")\n\ncox_standard &lt;- coxph(\n  Surv(time, status) ~ donor_type +\n    donor_age +\n    recipient_gender +\n    egfr_baseline,\n  data = stratified_kidney_data\n)\n\n#summary(cox_standard)\n\n#check the PH assumption first \nph_test &lt;- cox.zph(cox_standard)\nph_test\n\n\n                  chisq df       p\ndonor_type       28.127  1 1.1e-07\ndonor_age         0.118  1    0.73\nrecipient_gender  1.156  1    0.28\negfr_baseline     1.498  1    0.22\nGLOBAL           30.955  4 3.1e-06\n\n\nShow R code\nplot(ph_test)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nA small p-value indicates evidence against the proportional hazards assumption.\n\n\nInterpretation of PH diagnostics\nThe proportional hazards assumption is violated for donor type.\nOther covariates do not show strong evidence of violation.\nThe global test is significant, indicating overall non-proportionality.\nThis suggests that the effect of donor type on graft failure risk changes over time, making the standard Cox model inappropriate.\nStratified Cox model\nTo address this violation, we fit a stratified Cox model, stratifying on donor type.\n\n\nShow R code\nlibrary(survival)\ncox_strat &lt;- coxph(\nSurv(time, status) ~ donor_age + recipient_gender + egfr_baseline +\nstrata(donor_type),\ndata = stratified_kidney_data\n)\n\nsummary(cox_strat)\n\n\nCall:\ncoxph(formula = Surv(time, status) ~ donor_age + recipient_gender + \n    egfr_baseline + strata(donor_type), data = stratified_kidney_data)\n\n  n= 400, number of events= 171 \n\n                          coef exp(coef)  se(coef)      z Pr(&gt;|z|)   \ndonor_age             0.011126  1.011188  0.007488  1.486  0.13735   \nrecipient_gendermale  0.454309  1.575084  0.154436  2.942  0.00326 **\negfr_baseline        -0.014757  0.985351  0.006905 -2.137  0.03258 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                     exp(coef) exp(-coef) lower .95 upper .95\ndonor_age               1.0112     0.9889    0.9965    1.0261\nrecipient_gendermale    1.5751     0.6349    1.1637    2.1319\negfr_baseline           0.9854     1.0149    0.9721    0.9988\n\nConcordance= 0.574  (se = 0.023 )\nLikelihood ratio test= 14.83  on 3 df,   p=0.002\nWald test            = 14.66  on 3 df,   p=0.002\nScore (logrank) test = 14.83  on 3 df,   p=0.002\n\n\n\n\n\n\n\n\nNote\n\n\n\n\nWe no longer estimate a hazard ratio for donor type.\nDonor type is now used only to define separate baseline hazards.\nEffects of other covariates are assumed proportional within each stratum.\n\n\n\n\n\n\n\n\n\nInterpretation\n\n\n\nWithin each donor type (living and deceased), we interpret covariate effects as follows:\n‚úÖ Donor age\nHR ‚âà 1.01 (95% CI: 0.997‚Äì1.03, P-value=0.14), Not statistically significant.\nWithin each donor type, donor age shows no strong association with graft failure.\n‚úÖ Recipient gender (male)\nHR ‚âà 1.58 (95% CI: 1.16‚Äì2.13, P-value=0.003), Statistically significant. Male recipients have about 58% higher hazard of graft failure compared to females This comparison is within donor type, adjusting for donor age and eGFR.\n‚úÖ eGFR at transplant\nHR ‚âà 0.99 (95% CI: 0.97‚Äì1.00, P-value=0.033), Statistically significant. Each 1-unit increase in baseline eGFR is associated with about 1‚Äì2% lower hazard of graft failure, within each donor type. To improve interpretability, we can express the effect per 10-unit increase in eGFR:\n\\[\nHR_{10\\text{-unit}} = 0.99^{10} \\approx 0.90\n\\]\nInterpretation:\nWithin each donor type, a 10-unit higher eGFR at the time of transplant is associated with approximately a 10% lower hazard of graft failure, after adjusting for donor age and recipient gender.\n\n\n\n\n\n\n\n\nWhat about donor type?\n\n\n\nStratifying by donor type allows each group to have its own baseline hazard curve, effectively removing the need to assume a constant hazard ratio over time.\nThe curves demonstrate that living and deceased donor grafts follow different survival trajectories ‚Äî exactly what we expect when the PH assumption is violated.\n\n\n\n\nShow R code\n# cox_strat is the stratified cox model we fitted in previous chunk \nsf_strat &lt;- survfit(cox_strat)\n\n# Convert survfit to a tidy data frame for ggplot\nsf_df &lt;- data.frame(\n  time  = sf_strat$time,\n  surv  = sf_strat$surv,\n  lower = sf_strat$lower,\n  upper = sf_strat$upper,\n  strata = rep(names(sf_strat$strata), sf_strat$strata)\n)\n\n# Clean up the stratum labels from \"donor_type=deceased\" ‚Üí \"deceased\"\nsf_df$strata &lt;- sub(\"donor_type=\", \"\", sf_df$strata)\n\nlibrary(ggplot2)\n\nstratified_cox_plot&lt;-ggplot(sf_df, aes(x = time, y = surv, colour = strata)) +\n  geom_step(linewidth = 1.2) +\n  geom_ribbon(aes(ymin = lower, ymax = upper, fill = strata),\n              alpha = 0.15, linewidth = 0) +\n  scale_colour_manual(values = c(\"deceased\" = \"#365abd\",  # deep blue\n                                 \"living\"   = \"#c0397e\"))+ # magenta/rose\n\n  scale_fill_manual(values = c(\"deceased\" = \"#365abd\",\n                               \"living\"   = \"#c0397e\")) +\n  labs(\n    title = \"Stratified Cox Model\\nDifferent Baseline Hazards by Donor Type\",\n    x = \"Time since transplant (years)\",\n    y = \"Predicted survival probability\",\n    colour = \"Donor type\",\n    fill   = \"Donor type\"\n  ) +\n  coord_cartesian(ylim = c(0.4, 1)) +\n  theme_grey(base_size = 14) +\n  theme(\n    plot.title       = element_text(face = \"bold\", hjust = 0.5),\n    legend.position  = \"bottom\",\n    legend.title     = element_text(face = \"bold\")\n  )\n\nstratified_cox_plot\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWhy Ignoring PH Violations Can Be Misleading\n\n\n\nIf we ignore the violation of the proportional hazards (PH) assumption and proceed with a standard Cox model, we may obtain a single hazard ratio that does not accurately reflect how risk changes over time.\nThis can lead to misleading conclusions, as the estimated effect represents an average over follow-up rather than the true time-varying relationship.\nThis is illustrated in the plot below, where the separation between groups is clearly not constant over time.\n\n\n\n\nShow R code\n#data preparation for plot \n\nnew_deceased &lt;- data.frame(\n  donor_type = factor(\"deceased\", levels = levels(as.factor(stratified_kidney_data$donor_type))),\n  donor_age = mean(stratified_kidney_data$donor_age, na.rm = TRUE),\n  recipient_gender = factor(\"female\", levels = levels(as.factor(stratified_kidney_data$recipient_gender))),\n  egfr_baseline = mean(stratified_kidney_data$egfr_baseline, na.rm = TRUE)\n)\n\nnew_living &lt;- data.frame(\n  donor_type = factor(\"living\", levels = levels(as.factor(stratified_kidney_data$donor_type))),\n  donor_age = mean(stratified_kidney_data$donor_age, na.rm = TRUE),\n  recipient_gender = factor(\"female\", levels = levels(as.factor(stratified_kidney_data$recipient_gender))),\n  egfr_baseline = mean(stratified_kidney_data$egfr_baseline, na.rm = TRUE)\n)\n\n\n\n\n\nsf_deceased &lt;- survfit(cox_standard, newdata = new_deceased)\nsf_living   &lt;- survfit(cox_standard, newdata = new_living)\n\n\ndf_dec &lt;- data.frame(\n  time       = sf_deceased$time,\n  surv       = sf_deceased$surv,\n  lower      = sf_deceased$lower,\n  upper      = sf_deceased$upper,\n  donor_type = \"Deceased donor\"\n)\n\ndf_liv &lt;- data.frame(\n  time       = sf_living$time,\n  surv       = sf_living$surv,\n  lower      = sf_living$lower,\n  upper      = sf_living$upper,\n  donor_type = \"Living donor\"\n)\n\n\ndf_ph &lt;- rbind(df_dec, df_liv)\n\n\n\n\nstandard_cox_plot&lt;-ggplot(df_ph, aes(x = time, y = surv, colour = donor_type, fill = donor_type)) +\n  # CI ribbon\n  geom_ribbon(aes(ymin = lower, ymax = upper),\n              alpha = 0.2,\n              colour = NA,\n              show.legend = FALSE) +\n  # Step survival curve\n  geom_step(linewidth = 1.2) +\n  \n  # Manual colours for consistency across slides\n  scale_colour_manual(\n    values = c(\"Deceased donor\" = \"#365abd\",   # blue\n               \"Living donor\"   = \"#c0397e\")   # magenta/rose\n  ) +\n  scale_fill_manual(\n    values = c(\"Deceased donor\" = \"#365abd\",\n               \"Living donor\"   = \"#c0397e\")\n  ) +\n  \n  # Axis labels and title\n  labs(\n    title = \"Standard Cox PH Model\\nAssumes Constant Effect of Donor Type\",\n    x = \"Time since transplant (years)\",\n    y = \"Predicted survival probability\",\n    colour = \"Donor type\"\n  ) +\n  \n  # y-axis from 0.4 to 1.0\n  coord_cartesian(ylim = c(0.4, 1.0)) +\n  \n  # Use grey theme with gridlines\n  theme_grey(base_size = 14) +\n  theme(\n    plot.title       = element_text(face = \"bold\", hjust = 0.5),\n    legend.position  = \"bottom\",\n    legend.title     = element_text(face = \"bold\")\n  )\n\n\n\n\n \nlibrary(gridExtra)\nlibrary(ggplot2)\n\n# Reduce title size for each plot\nstandard_cox_plot_small &lt;- standard_cox_plot +\n  theme(plot.title = element_text(size = 10))\n\nstratified_cox_plot_small &lt;- stratified_cox_plot +\n  theme(plot.title = element_text(size = 10))\n\n# Arrange side by side\ngrid.arrange(\n  standard_cox_plot_small,\n  stratified_cox_plot_small,\n  ncol = 2\n)",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#including-time-varying-effects",
    "href": "lecture-03-non-ph-cox.html#including-time-varying-effects",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "6 Including Time-Varying Effects",
    "text": "6 Including Time-Varying Effects\nWhen the proportional hazards (PH) assumption is violated, stratification is not the only solution.\nIn some settings, we still want to:\n\nKeep the covariate in the model\nObtain an explicit effect estimate\nAllow the effect to change over time\n\nThis leads to a time-varying coefficient Cox model.\nWhen to Use Time-Varying Effects\nUse a time-varying effect when:\n\nThe PH assumption is violated for a variable (e.g.¬†donor type)\nThe variable is scientifically important\nYou believe the effect itself changes over time\n\nFor example:\n\nEarly after transplant, living donors may be protective\nLater, that advantage may diminish or reverse\n\nModel Idea\nIn the standard Cox model:\n\\[\nh(t \\mid X) = h_0(t)\\exp(\\beta_1 X_1 + \\beta_2 X_2 + \\cdots)\n\\]\nthe coefficients (\\(\\beta\\)) are assumed to be constant over time, which leads to the proportional hazards (PH) assumption.\nIf a covariate‚Äôs effect changes over time, we can allow its coefficient to depend on time:\n\\[\nh(t \\mid X) = h_0(t)\\exp\\left(\\beta_1(t) X_1 + \\beta_2 X_2 + \\cdots\\right)\n\\]\nThis allows the hazard ratio for \\(X_1\\) to vary with time.\n\n\n\n\n\n\nIntuition\n\n\n\nInstead of assuming the two groups keep the same relative risk forever,\nwe allow the risk difference between groups to change over time.\n\n\n\n\n\n\n\n\nWhen to Use It\n\n\n\n\nYou detect a proportional hazards (PH) violation for a variable (e.g.¬†donor type) but you still want an explicit effect estimate, rather than stratifying it away.\nFor example:\n\nEarly after transplant, living donors may be protective\nLater, that advantage may diminish or reverse",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#example-time-varying-effect-of-donor-type",
    "href": "lecture-03-non-ph-cox.html#example-time-varying-effect-of-donor-type",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "7 Example: Time-Varying Effect of Donor Type",
    "text": "7 Example: Time-Varying Effect of Donor Type\nWe return to the kidney transplant example:\n\nOutcome: time to graft failure\n\nExposure: donor type (living vs deceased)\n\nCovariates: donor age, recipient gender, baseline eGFR\n\nPreviously, we showed that donor type violates the PH assumption.\nWe introduce an interaction between the covariate and time, most commonly:\n\ndonor type √ó log(time)\n\ndonor type √ó time\n\nThis allows the model to estimate how the effect changes with time.\nThe Cox model becomes:\n\\[\nh(t) = h_0(t)\\exp\\left[\\beta_1 \\,\\text{donor\\_type} + \\beta_2 \\left(\\text{donor\\_type} \\times \\log(t)\\right) + \\cdots \\right]\n\\]\nWhere:\n\n\\(\\beta_1\\) represents the baseline (early) effect of donor type\n\n\\(\\beta_2\\) represents how that effect changes over time\n\n\n\nShow R code\nlibrary(survival)\n\nkidney_violate &lt;- read.csv(\"stratified_kidney_data.csv\")\n\nkidney_violate$donor_live &lt;- ifelse(kidney_violate$donor_type == \"living\", 1, 0)\n\ncox_timevary &lt;- coxph(\n  Surv(time, status) ~ donor_live +\n    donor_age +\n    recipient_gender +\n    egfr_baseline +\n    tt(donor_live),\n  data = kidney_violate,\n  tt = function(x, t, ...) {\n    x * log(t + 0.01)\n  }\n)\n\nsummary(cox_timevary)\n\n\nCall:\ncoxph(formula = Surv(time, status) ~ donor_live + donor_age + \n    recipient_gender + egfr_baseline + tt(donor_live), data = kidney_violate, \n    tt = function(x, t, ...) {\n        x * log(t + 0.01)\n    })\n\n  n= 400, number of events= 171 \n\n                          coef exp(coef)  se(coef)      z Pr(&gt;|z|)    \ndonor_live           -0.693440  0.499853  0.360232 -1.925  0.05423 .  \ndonor_age             0.011064  1.011126  0.007485  1.478  0.13935    \nrecipient_gendermale  0.455043  1.576241  0.154407  2.947  0.00321 ** \negfr_baseline        -0.014874  0.985236  0.006917 -2.150  0.03152 *  \ntt(donor_live)        1.261201  3.529659  0.252705  4.991 6.01e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                     exp(coef) exp(-coef) lower .95 upper .95\ndonor_live              0.4999     2.0006    0.2467    1.0127\ndonor_age               1.0111     0.9890    0.9964    1.0261\nrecipient_gendermale    1.5762     0.6344    1.1646    2.1333\negfr_baseline           0.9852     1.0150    0.9720    0.9987\ntt(donor_live)          3.5297     0.2833    2.1509    5.7921\n\nConcordance= 0.681  (se = 0.02 )\nLikelihood ratio test= 77.42  on 5 df,   p=3e-15\nWald test            = 64.54  on 5 df,   p=1e-12\nScore (logrank) test = 75.7  on 5 df,   p=7e-15\n\n\n\n\n\n\n\n\nNote\n\n\n\n\ndonor_live represents the baseline effect\ntt(donor_live) allows the effect to change with time\n\\(\\log(t)\\) captures gradual, nonlinear change\n\n\n\n\nVisualising the Time-Varying Hazard Ratio\n\n\nShow R code\nlibrary(ggplot2)\n\nb &lt;- coef(cox_timevary)\nv &lt;- vcov(cox_timevary)\n\nbeta1 &lt;- b[\"donor_live\"]\nbeta2 &lt;- b[\"tt(donor_live)\"]\n\nvar_beta1 &lt;- v[\"donor_live\", \"donor_live\"]\nvar_beta2 &lt;- v[\"tt(donor_live)\", \"tt(donor_live)\"]\ncov_b1b2  &lt;- v[\"donor_live\", \"tt(donor_live)\"]\n\nt_seq &lt;- seq(0.5, 8, by = 0.1)\nlog_t &lt;- log(t_seq + 0.01)\n\nlp &lt;- beta1 + beta2 * log_t\nvar_lp &lt;- var_beta1 + (log_t^2) * var_beta2 + 2 * log_t * cov_b1b2\nse_lp &lt;- sqrt(var_lp)\n\nhr_df &lt;- data.frame(\n  time  = t_seq,\n  HR    = exp(lp),\n  lower = exp(lp - 1.96 * se_lp),\n  upper = exp(lp + 1.96 * se_lp)\n)\n\nggplot(hr_df, aes(x = time, y = HR)) +\n  geom_ribbon(aes(ymin = lower, ymax = upper),\n              alpha = 0.2, fill = \"#c75b87\") +\n  geom_line(linewidth = 1.2, colour = \"#c75b87\") +\n  geom_hline(yintercept = 1,\n             linetype = \"dashed\",\n             colour = \"grey50\") +\n  labs(\n    title = \"Time-varying effect of donor type\",\n    subtitle = \"Hazard ratio: living vs deceased donor\",\n    x = \"Time since transplant (years)\",\n    y = \"Hazard ratio\"\n  ) +\n  theme_grey(base_size = 14) +\n  theme(\n    plot.title = element_text(face = \"bold\", hjust = 0.5),\n    plot.subtitle = element_text(hjust = 0.5),\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInterpretation\n\n\n\nWe interpret the results of the time-varying coefficient Cox model as follows:\n‚úÖ Donor type (living vs deceased) ‚Äî baseline effect\nHR ‚âà 0.50 (95% CI: 0.25‚Äì1.01, P-value ‚âà 0.05).\nAt the start of follow-up (when \\(\\log(t) \\approx 0\\)), recipients of a living donor kidney have about a 50% lower hazard of graft failure compared to recipients of deceased-donor kidneys.\nThis represents the early effect of donor type.\n\n‚úÖ Time-varying effect of donor type (tt(donor_live))\nHR ‚âà 3.53 (95% CI: 2.15‚Äì5.79, P-value &lt; 0.001), Statistically significant.\nThe effect of living donor changes significantly over time.\nFor each one-unit increase in \\(\\log(t)\\), the hazard ratio increases by a factor of about 3.5.\nInterpretation:\nThe early protective effect of living donation diminishes as time goes on, explaining why a single constant hazard ratio would be misleading.\n\n‚úÖ Donor age\nHR ‚âà 1.01 (95% CI: 1.00‚Äì1.03, P-value = 0.14), Not statistically significant.\nDonor age shows a small, non-significant trend toward higher hazard of graft failure.\n\n‚úÖ Recipient gender (male vs female)\nHR ‚âà 1.58 (95% CI: 1.16‚Äì2.13, P-value = 0.003), Statistically significant.\nMale recipients have about a 58% higher hazard of graft failure compared to females, adjusting for donor age, donor type, and baseline eGFR.\n\n‚úÖ Baseline eGFR\nHR ‚âà 0.99 (95% CI: 0.97‚Äì1.00, P-value = 0.032), Statistically significant.\nEach 1-unit increase in baseline eGFR is associated with about a 1‚Äì2% lower hazard of graft failure.\nTo improve interpretability, we can express the effect per 10-unit increase in eGFR:\n\\[\nHR_{10\\text{-unit}} = 0.99^{10} \\approx 0.90\n\\]\nInterpretation:\nWithin donor type, a 10-unit higher baseline eGFR at transplant is associated with approximately a 10% lower hazard of graft failure, after adjusting for other covariates.\n\nOverall interpretation:\nThe time-varying Cox model shows that the effect of donor type is strongest early after transplant and weakens over time, while recipient gender and baseline kidney function remain important predictors of graft failure.\nEarly follow-up: HR &lt; 1 ‚Üí protective effect of living donors\nLater follow-up: HR increases and may exceed 1\nUncertainty increases at longer follow-up due to fewer events\nThe HR steadily increases and crosses 1 after roughly 1‚Äì2 years, indicating the early survival advantage of living donors diminishes.\nBy 5‚Äì8 years, the HR &gt; 2‚Äì3, suggesting higher hazard among living-donor grafts in the later period.\nThe confidence band widens with time because there are fewer events and greater uncertainty at longer follow-up.",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#extended-cox-model",
    "href": "lecture-03-non-ph-cox.html#extended-cox-model",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "8 Extended Cox Model",
    "text": "8 Extended Cox Model\nBefore introducing the extended Cox model, it is important to distinguish between time-fixed covariates and time-varying covariates.\n\n\n\n\n\n\nTime-Fixed vs Time-Varying Covariates\n\n\n\nTime-Fixed Covariates:\nA time-fixed covariate is measured once (usually at baseline) and assumed to remain constant throughout follow-up.\nExamples:\n\nDonor type\nSex\nAge at transplant\nBaseline eGFR\n\nTime-Varying Covariates:\nA time-varying covariate is a variable whose value itself changes over time.\nExamples:\n\neGFR measured repeatedly after transplant\nBlood pressure\nMedication use\nBiomarkers measured at follow-up visits\n\n\n\n\n\n\n\n\n\nWarning\n\n\n\nTime-varying covariates are different from time-varying effects.\n\nTime-varying effect: the coefficient changes with time\n\nTime-varying covariate: the value of the covariate changes with time\n\n\n\nWhy Time-Varying Covariates Can Cause PH Violation\nIf we treat a changing covariate as fixed at baseline:\n\nWe ignore important changes in a patient‚Äôs risk profile\nThe model may show non-proportional hazards\nEarly and late risks are incorrectly averaged\n\nFor example:\n\neGFR at transplant may be similar between patients\nOver time, eGFR may decline at different rates\nCurrent kidney function is more relevant than baseline eGFR\n\nExtended Cox Model (Time-Varying Covariates)\nThe extended Cox model explicitly allows covariate values to change over time.\n\n\n\n\n\n\nIntuition\n\n\n\n\nSplit each subject‚Äôs follow-up into time intervals\nUpdate the covariate value within each interval\nModel the hazard using the current covariate value\n\nWhy this addresses PH violation:\n\nPH was violated partly because ‚Äúrisk profile changes over time.‚Äù\n\nThe extended Cox model explicitly updates the covariates over time instead of pretending they‚Äôre frozen at baseline.\n\nThis is different from stratification and different from adding x √ó time: here the value itself is time-dependent.\n\n\n\n\nThe model is written as:\n\\[\nh(t \\mid X(t)) = h_0(t)\\exp\\left(\\beta_1 X_1(t) + \\beta_2 X_2 + \\cdots\\right)\n\\]\n\n\n\n\n\n\nWhen to Use It\n\n\n\n\nA predictor changes over time\nThe current value of the predictor matters for risk right now\nTreating the variable as baseline-only is unrealistic\n\nExamples:\n\n‚ÄúeGFR at year 2 predicts risk between year 2 and 3‚Äù\n‚ÄúIf eGFR worsens, the risk of graft failure increases after that‚Äù",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  },
  {
    "objectID": "lecture-03-non-ph-cox.html#example-extended-cox-model-time-varying-covariates",
    "href": "lecture-03-non-ph-cox.html#example-extended-cox-model-time-varying-covariates",
    "title": "Lecture 3: Cox model when PH assumption is violated",
    "section": "9 Example: Extended Cox Model (Time-Varying Covariates)",
    "text": "9 Example: Extended Cox Model (Time-Varying Covariates)\nThis example demonstrates how to fit an extended Cox model when a covariate (e.g.¬†eGFR) changes over time.\nWe create a dataset in start‚Äìstop format, where each individual contributes multiple time intervals.\nFor each interval we record:\n\nstart: beginning of the time interval\n\nstop: end of the time interval\n\nstatus: did graft failure occur at stop\n\negfr_current: eGFR measured at the start of that interval\n\nThe extended Cox model uses the current value of the covariate:\n\\[\nh(t) = h_0(t)\\exp\\left(\\beta_1 \\,\\text{egfr\\_current}(t)\n+ \\beta_2 \\,\\text{donor\\_type}\n+ \\cdots \\right)\n\\]\nHere:\n\negfr_current(t) is updated over time\n\nThe hazard reflects the patient‚Äôs current kidney function, not baseline values\n\n\n\n\n\n\n\nData Structure: Wide vs Long Format\n\n\n\nWide (Baseline-Only) Format\nEach subject has one row, with multiple eGFR measurements stored in columns.\n\negfr0, egfr2, egfr4, egfr6 represent measurements at fixed times\n\nThis format is not suitable for extended Cox models\n\nLong (Start‚ÄìStop) Format\nEach subject contributes multiple rows, one per interval.\nKey columns:\n\nid\nstart\nstop\nstatus\negfr_current\nbaseline covariates (donor type, age, sex)\n\nThis format allows the model to use the current eGFR at each time interval.\n\n\nChange of eGFR over time by donor type\n\n\nShow R code\n#-----plot egfr change over time \nlibrary(ggplot2)\nlibrary(dplyr)\n\nlong_data&lt;-read.csv(\"egfr_long_data.CSV\")\n\n# Compute mean ¬± SE by donor type and start time\negfr_summary &lt;- long_data %&gt;%\n  group_by(donor_type, start) %&gt;%\n  summarise(\n    mean_egfr = mean(egfr_current, na.rm = TRUE),\n    se_egfr   = sd(egfr_current, na.rm = TRUE) / sqrt(n())\n  )\n\nggplot(egfr_summary, aes(x = start, y = mean_egfr,\n                         colour = donor_type, group = donor_type)) +\n  geom_line(linewidth = 1.2) +     # changed from size ‚Üí linewidth\n  geom_point(size = 2) +\n  geom_ribbon(aes(ymin = mean_egfr - se_egfr,\n                  ymax = mean_egfr + se_egfr,\n                  fill = donor_type),\n              alpha = 0.2, colour = NA) +\n  scale_colour_manual(values = c(\"deceased\" = \"#377eb8\",\n                                 \"living\"   = \"#e41a1c\")) +\n  scale_fill_manual(values = c(\"deceased\" = \"#377eb8\",\n                               \"living\"   = \"#e41a1c\")) +\n  labs(\n    title  = \"Average eGFR trajectory over time by donor type\",\n    x      = \"Years since transplant\",\n    y      = \"Mean eGFR (mL/min/1.73m¬≤)\",\n    colour = \"Donor type\",\n    fill   = \"Donor type\"\n  ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    panel.grid.major = element_line(colour = \"grey90\"),\n    panel.grid.minor = element_blank(),\n    plot.title       = element_text(face = \"bold\", hjust = 0.5)\n  )\n\n\n\n\n\n\n\n\n\nFitting the Extended Cox Model\n\n\nShow R code\nlibrary(survival)\n\nlong_data&lt;-read.csv(\"egfr_long_data.CSV\")\n\ncox_extended &lt;- coxph(\n  Surv(start, stop, status) ~\n    egfr_current +\n    donor_type +\n    donor_age +\n    recipient_gender,\n  data = long_data\n)\n\nsummary(cox_extended)\n\n\nCall:\ncoxph(formula = Surv(start, stop, status) ~ egfr_current + donor_type + \n    donor_age + recipient_gender, data = long_data)\n\n  n= 984, number of events= 13 \n\n                         coef exp(coef) se(coef)      z Pr(&gt;|z|)   \negfr_current         -0.08300   0.92035  0.03222 -2.576    0.010 **\ndonor_typeliving      0.24888   1.28259  0.85365  0.292    0.771   \ndonor_age             0.02599   1.02633  0.03043  0.854    0.393   \nrecipient_gendermale  0.31097   1.36475  0.56113  0.554    0.579   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                     exp(coef) exp(-coef) lower .95 upper .95\negfr_current            0.9204     1.0865    0.8640    0.9803\ndonor_typeliving        1.2826     0.7797    0.2407    6.8346\ndonor_age               1.0263     0.9743    0.9669    1.0894\nrecipient_gendermale    1.3648     0.7327    0.4544    4.0991\n\nConcordance= 0.756  (se = 0.074 )\nLikelihood ratio test= 12.1  on 4 df,   p=0.02\nWald test            = 9.91  on 4 df,   p=0.04\nScore (logrank) test = 10.88  on 4 df,   p=0.03\n\n\n\n\n\n\n\n\nInterpretation\n\n\n\nWe interpret the results of the extended Cox model (time-varying covariates) as follows:\n‚úÖ Current eGFR\nHR ‚âà 0.92 (95% CI: 0.86‚Äì0.98, P-value = 0.01), Statistically significant.\nEach 1 mL/min/1.73 m¬≤ higher current eGFR is associated with about an 8% lower instantaneous hazard of graft failure, holding donor type, donor age, and recipient gender constant.\nThis means that the patient‚Äôs current kidney function, rather than baseline eGFR, is strongly predictive of graft failure risk.\n\n‚úÖ Donor type (living vs deceased)\nHR ‚âà 1.28 (95% CI: 0.24‚Äì6.83, P-value = 0.77), Not statistically significant.\nOnce time-updated eGFR is included in the model, there is no evidence of a direct effect of donor type on graft failure.\nInterpretation:\nThe apparent advantage of living donors observed earlier appears to operate through better kidney function over time, rather than through an independent direct effect.\n\n‚úÖ Donor age\nHR ‚âà 1.03 (95% CI: 0.97‚Äì1.09, P-value = 0.39), Not statistically significant.\nThere is no strong evidence that donor age is associated with graft failure once current eGFR and other covariates are accounted for.\n\n‚úÖ Recipient gender (male vs female)\nHR ‚âà 1.36 (95% CI: 0.45‚Äì4.10, P-value = 0.58), Not statistically significant.\nAfter adjusting for time-updated eGFR and other covariates, there is no clear evidence of a gender difference in graft failure risk.\n\nOverall interpretation:\nThe extended Cox model highlights that time-updated eGFR is the dominant predictor of graft failure.\nAccounting for changes in kidney function over time substantially alters the interpretation of other covariate effects and provides a more realistic representation of evolving risk.\n\n\n\n\nShow R code\nlibrary(survival)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Choose fixed values (you can edit if you prefer):\nref_donor_type      &lt;- factor(\"deceased\", levels = levels(as.factor(long_data$donor_type)))\nref_donor_age       &lt;- 50\nref_recipient_sex   &lt;- factor(\"female\", levels = levels(as.factor(long_data$recipient_gender)))\n\nnew_e30 &lt;- data.frame(\n  start = 0,\n  stop = 1,  # dummy, survfit won't use start/stop here\n  status = 0,\n  egfr_current = 30,\n  donor_type = ref_donor_type,\n  donor_age = ref_donor_age,\n  recipient_gender = ref_recipient_sex\n)\n\nnew_e60 &lt;- new_e30; new_e60$egfr_current &lt;- 60\nnew_e90 &lt;- new_e30; new_e90$egfr_current &lt;- 90\n\n\nsf_e30 &lt;- survfit(cox_extended, newdata = new_e30)\nsf_e60 &lt;- survfit(cox_extended, newdata = new_e60)\nsf_e90 &lt;- survfit(cox_extended, newdata = new_e90)\n\n\ndf_e30 &lt;- data.frame(\n  time  = sf_e30$time,\n  surv  = sf_e30$surv,\n  lower = sf_e30$lower,\n  upper = sf_e30$upper,\n  egfr_label = \"eGFR = 30\"\n)\n\ndf_e60 &lt;- data.frame(\n  time  = sf_e60$time,\n  surv  = sf_e60$surv,\n  lower = sf_e60$lower,\n  upper = sf_e60$upper,\n  egfr_label = \"eGFR = 60\"\n)\n\ndf_e90 &lt;- data.frame(\n  time  = sf_e90$time,\n  surv  = sf_e90$surv,\n  lower = sf_e90$lower,\n  upper = sf_e90$upper,\n  egfr_label = \"eGFR = 90\"\n)\n\nsurv_plot_df &lt;- bind_rows(df_e30, df_e60, df_e90)\n\n\nggplot(surv_plot_df,\n       aes(x = time,\n           y = surv,\n           colour = egfr_label,\n           fill   = egfr_label)) +\n  \n  # confidence band\n  geom_ribbon(aes(ymin = lower, ymax = upper),\n              alpha = 0.18,\n              linewidth = 0,\n              show.legend = FALSE) +\n  \n  # survival curve (step)\n  geom_step(linewidth = 1.2) +\n  \n  scale_colour_manual(\n    values = c(\n      \"eGFR = 30\" = \"#d7301f\",  # dark-ish red / high risk\n      \"eGFR = 60\" = \"#fc8d59\",  # orange\n      \"eGFR = 90\" = \"#1a9850\"   # green / low risk\n    )\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"eGFR = 30\" = \"#d7301f\",\n      \"eGFR = 60\" = \"#fc8d59\",\n      \"eGFR = 90\" = \"#1a9850\"\n    )\n  ) +\n  \n  labs(\n    title = \"Predicted graft survival under different kidney function levels\",\n    subtitle = \"Extended Cox model with time-updated eGFR\",\n    x = \"Time since transplant (years)\",\n    y = \"Survival probability\",\n    colour = \"Assumed current eGFR\"\n  ) +\n  coord_cartesian(ylim = c(0.72, 1)) +\n  theme_grey(base_size = 14) +\n  theme(\n    plot.title    = element_text(face = \"bold\", hjust = 0.5),\n    plot.subtitle = element_text(hjust = 0.5),\n    legend.position = \"right\",\n    panel.grid.minor = element_blank()\n  )+ theme(\n    plot.title = element_text(\n      face = \"bold\",\n      size = 12,\n      hjust = 0.5,\n      margin = margin(b = 6)   # space below title\n    ),\n    plot.subtitle = element_text(\n      size = 11,\n      hjust = 0.5,\n      margin = margin(b = 8)\n    ),\n    legend.position = \"right\",\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInterpretation of Predicted Survival by Current eGFR Level\n\n\n\nThe extended Cox model allows us to interpret graft survival conditional on the current level of kidney function, updated over time.\n\n‚úÖ eGFR = 90 (green)\nPredicted graft survival is very stable over time.\nThe survival curve remains close to 1.0, indicating that patients maintaining this level of kidney function have a very low risk of graft failure throughout follow-up.\n\n‚úÖ eGFR = 60 (orange)\nGraft survival remains high, although slightly lower than at eGFR = 90.\nThe probability of graft survival stays above 95% over 8 years, suggesting a modest increase in risk, but overall good long-term outcomes.\n\n‚úÖ eGFR = 30 (red)\nGraft survival is markedly reduced.\nThe survival curve declines more steeply, showing a pronounced increase in the risk of graft loss over time.\nThis highlights low current eGFR as a strong indicator of poor prognosis.\n\nOverall interpretation:\nIn the extended Cox model, current eGFR is a powerful, time-updated predictor of graft survival.\nLower eGFR values are associated with substantially worse survival trajectories, reinforcing the importance of modelling kidney function as a time-varying covariate rather than a baseline-only measure.\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThe extended Cox model treats time-varying covariates as external.\nIf the covariate is influenced by the underlying disease process (e.g.¬†declining eGFR because the graft is failing), this assumption may be violated.\n\n\n\nüß† Think about the following before moving on:\nWhat if the decline in eGFR over time reflects underlying changes in other clinical factors, rather than acting as an isolated predictor?\nAnd those same variables may also affect the risk of graft failure.\nIf a time-dependent covariate both predicts the event and is affected by the underlying disease process, is an extended Cox model still appropriate?",
    "crumbs": [
      "Lectures",
      "Lecture 3: Cox model when PH assumption is violated"
    ]
  }
]