[
  {
    "objectID": "lecture-02-cox-ph.html",
    "href": "lecture-02-cox-ph.html",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nUnderstand what the hazard represents\nFit a Cox proportional hazards (PH) model in R\nCheck the proportional hazards assumption\nInterpret hazard ratios (HRs)\nUnderstand when Cox and RMST answer different questions",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#learning-objectives",
    "href": "lecture-02-cox-ph.html#learning-objectives",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nUnderstand what the hazard represents\nFit a Cox proportional hazards (PH) model in R\nCheck the proportional hazards assumption\nInterpret hazard ratios (HRs)\nUnderstand when Cox and RMST answer different questions",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#survival-probability-vs-hazard",
    "href": "lecture-02-cox-ph.html#survival-probability-vs-hazard",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "2 Survival Probability vs Hazard",
    "text": "2 Survival Probability vs Hazard\n\nSurvival probability answers:\nWhat proportion of patients are still event-free by time \\(t\\)?\nHazard answers:\nHow quickly are events happening right now among those still at risk?\n\n\n\n\n\n\n\nNote\n\n\n\nSurvival is cumulative over time.\nHazard is instantaneous risk at a given moment.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#risk-and-hazard-at-time-t",
    "href": "lecture-02-cox-ph.html#risk-and-hazard-at-time-t",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "3 Risk and Hazard at Time \\(t\\)",
    "text": "3 Risk and Hazard at Time \\(t\\)\nWe follow people from a start point (e.g., transplant) until an event (e.g., graft failure) or censoring.\nRisk Set at Time \\(t\\)\nAt time \\(t\\), the risk set includes only individuals who:\n\nhave not yet experienced the event, and\nhave not been censored before time \\(t\\)\n\nThese are the only individuals who are considered at risk at time \\(t\\).\nHazard at Time \\(t\\)\nAmong individuals who are still event-free at time \\(t\\), the hazard describes:\n\nHow quickly events are occurring at that exact moment.\n\nFormally, the hazard function is defined as:\n\\[\nh(t) = \\lim_{\\Delta t \\to 0}\n\\frac{\\Pr(\\text{event in } [t, t+\\Delta t) \\mid \\text{survived to } t)}{\\Delta t}\n\\]\n\n\n\n\n\n\nNote\n\n\n\nThe hazard is a rate, not a probability.\nIt can be larger than 1 and does not represent the chance of failure by time \\(t\\).",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#from-hazard-to-short-term-risk",
    "href": "lecture-02-cox-ph.html#from-hazard-to-short-term-risk",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "4 From Hazard to Short-Term Risk",
    "text": "4 From Hazard to Short-Term Risk\nThe hazard describes how fast events are occurring at an instant, but it is not itself a probability.\nTo approximate the short-term risk of experiencing the event, we look at a small time window of length \\(\\Delta t\\).\nFor very small \\(\\Delta t\\), the probability of the event occurring shortly after time \\(t\\) is approximately:\n\\[\n\\Pr(\\text{event in the next } \\Delta t \\mid \\text{alive at } t)\n\\;\\approx\\;\nh(t) \\times \\Delta t\n\\]\n\n\n\n\n\n\nNote\n\n\n\nThis approximation helps link the hazard to a more intuitive concept of short-term risk. However, hazard itself is still a rate, not a probability.\n\n\n\n\n\n\n\n\nExample\n\n\n\n\nAt 12 months, 80 people are still at risk.\n\nBetween 12 and 13 months, 4 events occur.\n\nThe average monthly hazard over that interval ‚âà 4/80=0.05 per month.\n\nSo the risk during that month ‚âà 5% (because 0.05 √ó 1 month).",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#what-is-the-link-between-hazard-and-survival",
    "href": "lecture-02-cox-ph.html#what-is-the-link-between-hazard-and-survival",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "5 What Is the Link Between Hazard and Survival?",
    "text": "5 What Is the Link Between Hazard and Survival?\n- Cumulative Hazard\nThe cumulative hazard up to time \\(t\\) is the total hazard accumulated over time:\n\\[\nH(t) = \\int_0^t h(u)\\, du\n\\]\n- Survival Function\nThe survival probability at time \\(t\\) is related to the cumulative hazard by:\n\\[\nS(t) = \\exp\\{-H(t)\\}\n\\]\nThis means that survival depends on the entire history of the hazard, not just the hazard at a single time point.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#speedometer-and-odometer-analogy",
    "href": "lecture-02-cox-ph.html#speedometer-and-odometer-analogy",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "6 üöó Speedometer and Odometer Analogy",
    "text": "6 üöó Speedometer and Odometer Analogy\n\n\n\n\n\n\nNote\n\n\n\nThink of hazard as a speedometer and survival as an odometer.\n\n\nIf we know the speed at every moment, we can calculate the total distance travelled by adding up (integrating) the speed over time.\nSimilarly:\n\nIf we know the hazard at each moment,\n\nwe can calculate the cumulative hazard by integrating over time,\n\nand from the cumulative hazard we can determine the survival probability.\n\nSurvival tells us how far we have made it without experiencing the event since the starting point.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#what-does-the-cox-model-do",
    "href": "lecture-02-cox-ph.html#what-does-the-cox-model-do",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "7 What Does the Cox Model Do?",
    "text": "7 What Does the Cox Model Do?\nIn practice, individuals have different characteristics that may affect their risk of experiencing the event.\nThe Cox proportional hazards model describes how covariates change the hazard over time:\n\\[\nh(t \\mid X) = h_0(t)\\exp(\\beta_1 X_1 + \\beta_2 X_2 + \\cdots + \\beta_p X_p)\n\\]\nwhere:\n\n\\(h(t \\mid X)\\) is the hazard for an individual with covariates \\(X\\)\n\\(h_0(t)\\) is the baseline hazard (when all \\(X = 0\\))\n\\(\\beta\\) values describe how covariates affect the hazard\n\n\n\n\n\n\n\nNote\n\n\n\nThe Cox model does not require specifying the shape of \\(h_0(t)\\). It focuses on estimating relative differences in hazard between individuals.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#what-is-a-hazard-ratio",
    "href": "lecture-02-cox-ph.html#what-is-a-hazard-ratio",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "8 What Is a Hazard Ratio?",
    "text": "8 What Is a Hazard Ratio?\nFor a one-unit increase in a covariate \\(X_j\\), the hazard ratio is:\n\\[\nHR = \\exp(\\beta_j)\n\\]\nThis represents the ratio of hazards between two individuals who differ by one unit in \\(X_j\\),\nholding all other covariates constant.\n\n\n\n\n\n\nInterpretation\n\n\n\n\n\\(HR = 1\\): no difference in hazard\n\n\\(HR &lt; 1\\): lower hazard (protective effect)\n\n\\(HR &gt; 1\\): higher hazard (increased risk)",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#cox-ph-model-assumptions",
    "href": "lecture-02-cox-ph.html#cox-ph-model-assumptions",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "9 Cox PH model assumptions",
    "text": "9 Cox PH model assumptions\n1. Proportional Hazards (PH)\nThe hazard ratio between groups is constant over time. Example: If \\(HR = 0.6\\) at 1 year, it should also be 0.6 at 5 years.\n2. Linearity of Continuous Covariates\nContinuous variables (e.g., age, eGFR) affect the log hazard in a linear way. If not, we may need transformations or splines.\n3. Independent Censoring\nCensoring (loss to follow-up, end of study) is unrelated to the future risk of the event.\n4. Correct Model Specification\nAll important predictors are included, and no important variables are mis-specified.",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#example-kidney-transplant-study",
    "href": "lecture-02-cox-ph.html#example-kidney-transplant-study",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "10 Example: Kidney Transplant Study",
    "text": "10 Example: Kidney Transplant Study\nWe are interested in whether donor type (living vs deceased) is associated with the hazard of graft failure over time, after adjusting for donor age, recipient sex, and baseline eGFR at the time of transplant.\nOutcome\n- Time to graft failure (months since transplant)\nEvent Indicator: Graft failure status\n- 1 = failure\n- 0 = censored\nMain Exposure\n- Donor type (Living vs Deceased)\nCovariates\n- Donor age (years)\n- Recipient sex (male / female)\n- eGFR at transplant\n\n\n\n\n\n\nNote\n\n\n\nWe use simulated transplant data for illustration.\n\n\n\n\nShow R code\nlibrary(survival)\nlibrary(dplyr)\n\ndf &lt;- read.csv(\"simulated_data.csv\")\n\ndf$recipient_sex &lt;- factor(df$recipient_sex, levels = c(\"Male\", \"Female\"))\ndf$donor_type &lt;- factor(df$donor_type, levels = c(\"Deceased\", \"Living\"))\n\nhead(df)\n\n\n  id  time status donor_type donor_age recipient_sex egfr_at_tx\n1  1  41.6      0     Living        32          Male       34.9\n2  2  38.7      0   Deceased        64        Female       12.6\n3  3   0.9      0   Deceased        64          Male       45.5\n4  4  13.3      0   Deceased        44          Male       41.0\n5  5 131.9      1     Living        59          Male       31.1\n6  6  14.5      0     Living        37          Male       31.5",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#fit-the-cox-model",
    "href": "lecture-02-cox-ph.html#fit-the-cox-model",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "11 Fit the Cox Model",
    "text": "11 Fit the Cox Model\n\n\nShow R code\ncox_model &lt;- coxph(\nSurv(time, status) ~ donor_type + donor_age + recipient_sex + egfr_at_tx,\ndata = df\n)\n\nsummary(cox_model)\n\n\nCall:\ncoxph(formula = Surv(time, status) ~ donor_type + donor_age + \n    recipient_sex + egfr_at_tx, data = df)\n\n  n= 1000, number of events= 470 \n\n                         coef exp(coef)  se(coef)      z Pr(&gt;|z|)    \ndonor_typeLiving    -0.603679  0.546796  0.117873 -5.121 3.03e-07 ***\ndonor_age            0.020758  1.020975  0.004604  4.509 6.52e-06 ***\nrecipient_sexFemale  0.060762  1.062646  0.093337  0.651    0.515    \negfr_at_tx          -0.026328  0.974015  0.003046 -8.645  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n                    exp(coef) exp(-coef) lower .95 upper .95\ndonor_typeLiving       0.5468     1.8288    0.4340    0.6889\ndonor_age              1.0210     0.9795    1.0118    1.0302\nrecipient_sexFemale    1.0626     0.9410    0.8850    1.2760\negfr_at_tx             0.9740     1.0267    0.9682    0.9798\n\nConcordance= 0.661  (se = 0.013 )\nLikelihood ratio test= 160.2  on 4 df,   p=&lt;2e-16\nWald test            = 151.8  on 4 df,   p=&lt;2e-16\nScore (logrank) test = 156.1  on 4 df,   p=&lt;2e-16",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#checking-model-assumptions",
    "href": "lecture-02-cox-ph.html#checking-model-assumptions",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "12 Checking Model Assumptions",
    "text": "12 Checking Model Assumptions\n1. Proportional Hazards (PH) Assumption\nThe Cox model assumes that hazard ratios are constant over time.\nWe assess this using Schoenfeld residuals.\n\n\nShow R code\nph_test &lt;- cox.zph(cox_model)\nph_test\n\n\n               chisq df     p\ndonor_type    4.4452  1 0.035\ndonor_age     2.9643  1 0.085\nrecipient_sex 0.0295  1 0.864\negfr_at_tx    2.1768  1 0.140\nGLOBAL        6.2504  4 0.181\n\n\nShow R code\nplot(ph_test)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nIf the global test is not significant, the PH assumption is reasonable.\n\n\n2. Linearity of Continuous Covariates\nThe Cox model assumes that continuous covariates have a linear effect on the log-hazard.\nIf this assumption is violated, the model may be misspecified.\nA common diagnostic is to plot Martingale residuals against each continuous covariate:\n\n\nShow R code\nmart_resid &lt;- residuals(cox_model, type = \"martingale\")\n\n# Plot residuals vs continuous covariates\n\n\nplot(df$donor_age, mart_resid,\n     xlab = \"Donor age (years)\", ylab = \"Martingale residuals\",\n     main = \"Linearity check: Donor age\")\nlines(lowess(df$donor_age, mart_resid), lwd = 2)\n\n\n\n\n\n\n\n\n\nShow R code\nplot(df$egfr_at_tx, mart_resid,\n     xlab = \"eGFR at transplant\", ylab = \"Martingale residuals\",\n     main = \"Linearity check: eGFR\")\nlines(lowess(df$egfr_at_tx, mart_resid), lwd = 2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nIf the linearity assumption holds, the scatter of residuals should look randomly spread around zero with no strong curvature.\nIf you see a systematic curve/trend, that suggests non-linearity, and you might need transformations (e.g.¬†log, quadratic, splines).",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "lecture-02-cox-ph.html#model-interpretation",
    "href": "lecture-02-cox-ph.html#model-interpretation",
    "title": "Lecture 2: Cox proportional hazards model",
    "section": "13 Model Interpretation",
    "text": "13 Model Interpretation\n-Donor type:\nRecipients of living donor kidneys had a 45% lower hazard of graft failure compared with those who received deceased donor kidneys (HR = 0.55, 95% CI: 0.43‚Äì0.69, p &lt; 0.001).\n-Donor age:\nEach additional year of donor age was associated with a 2% increase in hazard of graft failure (HR = 1.02, 95% CI: 1.01‚Äì1.03, p &lt; 0.001).\nHow to improve the reporting HR for donor age?\nDonor age: Each 10-year increase in donor age was associated with a 22% increase in the hazard of graft failure (HR = 1.22, 95% CI: 1.13‚Äì1.34, p &lt; 0.001).\n-Recipient sex:\nThere was no evidence of an association between recipient sex and graft failure (HR = 1.06, 95% CI: 0.89‚Äì1.28, p = 0.52).\n-eGFR at transplant:\nHigher baseline eGFR was strongly protective: each 1-unit increase was associated with a 3% lower hazard of graft failure (HR = 0.97, 95% CI: 0.97‚Äì0.98, p &lt; 0.001).\n\n\n\n\n\n\nConnection to RMST\n\n\n\nIf hazards are not proportional:\nHazard ratios may be misleading\nRMST provides an absolute, time-based summary\nRMST does not rely on the PH assumption\nThis motivates using RMST as an alternative or complement to Cox models.\n\n\n\nThink about the following before moving on:\nWhat should we do if the proportional hazards assumption is violated?\nHow could we model time-varying effects?\nWhen would RMST be preferable to the Cox proportional hazards model?",
    "crumbs": [
      "Lectures",
      "Lecture 2: Cox proportional hazards model"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Advanced Survival Concepts and Analysis",
    "section": "",
    "text": "Welcome! This workshop contains 5 lectures on survival analysis.\n\n\n\n\n\n\nHow to use this website\n\n\n\n\nClick Lecture 1‚Äì5 in the sidebar.\nEach lecture contains:\n\nexplanation\nR code (collapsible)\noutputs\ninterpretation",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n\nShow R code\n1 + 1\n\n\n[1] 2"
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html",
    "href": "lecture-01-intro-km-rmst.html",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nDescribe what makes survival data different from standard outcomes\nExplain how Kaplan‚ÄìMeier survival curves are constructed\nInterpret censoring in survival analysis\nIdentify the limitations of Kaplan‚ÄìMeier curves\nUnderstand the motivation for Restricted Mean Survival Time (RMST)\nInterpret RMST differences and ratios in applied settings",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#learning-objectives",
    "href": "lecture-01-intro-km-rmst.html#learning-objectives",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "",
    "text": "Note\n\n\n\nBy the end of this lecture, you should be able to:\n\nDescribe what makes survival data different from standard outcomes\nExplain how Kaplan‚ÄìMeier survival curves are constructed\nInterpret censoring in survival analysis\nIdentify the limitations of Kaplan‚ÄìMeier curves\nUnderstand the motivation for Restricted Mean Survival Time (RMST)\nInterpret RMST differences and ratios in applied settings",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#what-is-survival-data",
    "href": "lecture-01-intro-km-rmst.html#what-is-survival-data",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "2 What is survival data?",
    "text": "2 What is survival data?\nSurvival data measure the time until a specific event occurs.\nExamples in kidney research include:\n- Time from transplantation to graft failure\n- Time from transplant to patient death\n- Time to acute rejection\n\n\n\n\n\n\nKey feature of survival data\n\n\n\nThe outcome is composite: - a time variable - an event indicator\n(1 = event occurred, 0 = censored)\nThese two components must always be analysed together.",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#kaplanmeier-survival-curves",
    "href": "lecture-01-intro-km-rmst.html#kaplanmeier-survival-curves",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "3 Kaplan‚ÄìMeier survival curves",
    "text": "3 Kaplan‚ÄìMeier survival curves\nA Kaplan‚ÄìMeier (KM) curve estimates the probability of remaining event-free beyond a given time.\nThe KM method is a non-parametric approach used to estimate the survival function.\n\nIt estimates the probability of surviving beyond a given time.\nIt appropriately handles censoring, where some individuals have not experienced the event by the end of follow-up.\n\nThe Kaplan‚ÄìMeier estimator at time \\(t_i\\) is defined as:\n\\[\n\\hat{S}(t_i) = \\hat{S}(t_{i-1}) \\times \\left( 1 - \\frac{d_i}{r_i} \\right)\n\\]\nwhere:\n\n$ d_i $ is the number of events occurring at time $ t_i $\n$ r_i $ is the number of individuals at risk just before time $ t_i $\n\n\n\n\n\n\n\nHow to read a Kaplan‚ÄìMeier curve\n\n\n\n\nThe curve decreases in steps, not smoothly\nEach drop corresponds to an event time\nFlat sections indicate no events\nCensored observations:\n\ndo not cause the curve to drop\nreduce the number at risk going forward",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#example-simple-kaplanmeier-estimate",
    "href": "lecture-01-intro-km-rmst.html#example-simple-kaplanmeier-estimate",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "4 Example: simple Kaplan‚ÄìMeier estimate",
    "text": "4 Example: simple Kaplan‚ÄìMeier estimate\nThis dataset captures the time from kidney transplantation to graft failure. The only predictor variable included is donor type.\n\n\n\nID\nGraft failure\nTime to graft failure (months)\nDonor type\n\n\n\n\n1\n1\n3\nLiving\n\n\n2\n0\n5\nDeceased\n\n\n3\n1\n6\nLiving\n\n\n4\n1\n8\nDeceased\n\n\n5\n0\n10\nLiving\n\n\n6\n1\n12\nDeceased\n\n\n\nThe KM estimates can be written as follows:\n\n\n\n\n\n\n\n\n\nSorted time\nGraft failure\nNumber of people at risk\nSurvival probability\n\n\n\n\n0\n‚Äì\n6\n1.000\n\n\n3\n1\n6\n1 √ó (1 ‚àí 1/6) = 0.833\n\n\n6\n1\n4\n0.833 √ó (1 ‚àí 1/4) = 0.625\n\n\n8\n1\n3\n0.625 √ó (1 ‚àí 1/3) = 0.417\n\n\n12\n1\n2\n0.417 √ó (1 ‚àí 1/1) = 0\n\n\n\n\n\nShow R code\nlibrary(survival)\nlibrary(survminer)\n\ndf &lt;- data.frame(\n  id = 1:6,\n  time = c(3, 5, 6, 8, 10, 12),\n  status = c(1, 0, 1, 1, 0, 1)\n)\n\nkm_fit &lt;- survfit(Surv(time, status) ~ 1, data = df)\n\nggsurvplot(\n  km_fit,\n  data = df,\n  censor = TRUE,\n  risk.table = TRUE,\n  xlab = \"Time from transplant (months)\",\n  ylab = \"Survival probability\",\n  ggtheme = theme_minimal()\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInterpretation\n\n\n\nAt any given time point, the survival probability represents the estimated proportion of individuals who remain event-free beyond that time.\nCensored individuals:\n- contribute information up to their censoring time\n- do not count as failures\n- do not cause drops in the curve",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#kaplanmeier-curves-by-donor-type",
    "href": "lecture-01-intro-km-rmst.html#kaplanmeier-curves-by-donor-type",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "5 Kaplan‚ÄìMeier curves by donor type",
    "text": "5 Kaplan‚ÄìMeier curves by donor type\nThe simulated data contains the time from kidney transplantation to graft failure. The only predictor variable included is donor type.\n\n\nShow R code\nset.seed(2025)\n\nn &lt;- 200\ndonor_type &lt;- sample(c(\"Living\", \"Deceased\"), n, replace = TRUE)\n\ntime &lt;- ifelse(donor_type == \"Living\",\n               rexp(n, rate = 0.05),\n               rexp(n, rate = 0.1))\n\ncensoring_time &lt;- rexp(n, rate = 0.05)\nobserved_time &lt;- pmin(time, censoring_time)\nstatus &lt;- as.integer(time &lt;= censoring_time)\n\ndf &lt;- data.frame(\n  time = round(observed_time, 1),\n  status = status,\n  donor_type = donor_type\n)\n\nkm_fit &lt;- survfit(Surv(time, status) ~ donor_type, data = df)\n\nggsurvplot(\n  km_fit,\n  data = df,\n  risk.table = TRUE,\n  pval = TRUE,\n  conf.int = TRUE,\n  legend.title = \"Donor type\",\n  xlab = \"Time to graft failure (months)\",\n  ylab = \"Survival probability\",\n  ggtheme = theme_minimal()\n)",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#limitation-of-kaplanmeier-curves",
    "href": "lecture-01-intro-km-rmst.html#limitation-of-kaplanmeier-curves",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "6 Limitation of Kaplan‚ÄìMeier curves",
    "text": "6 Limitation of Kaplan‚ÄìMeier curves\n\n\n\n\n\n\nWarning\n\n\n\nKaplan‚ÄìMeier curves allow group comparison only.\nThey cannot:\n- adjust for confounders\n- include continuous predictors\nFor adjusted analyses, we need regression-based approaches, such as Cox regression or RMST regression.",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#restricted-mean-survival-time-rmst",
    "href": "lecture-01-intro-km-rmst.html#restricted-mean-survival-time-rmst",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "7 Restricted Mean Survival Time (RMST)",
    "text": "7 Restricted Mean Survival Time (RMST)\nSo far, we‚Äôve seen that Kaplan-Meier does not adjust for confounders. To handle covariates, we need approaches like:\n- Cox regression\n- RMST regression\n- Parametric survival models\nIn censored data, the true mean survival time is often not observable. We don‚Äôt have event time for some of the individual they may not experience the event.\nBecause of censoring, estimating the unrestricted mean survival time is often not feasible. Instead, we define a fixed time point \\(ùùâ\\) and focus on Restricted Mean Survival Time (RMST):\nThe average time survived up to time \\(ùùâ\\).\n\n\n\n\n\n\nNote\n\n\n\nRMST is the average time survived up to a fixed time point œÑ.\nIt answers the question:\n\n‚ÄúHow long, on average, do individuals remain event-free within œÑ months?‚Äù\n\n\n\n\n\n\n\n\n\nWhy RMST is attractive\n\n\n\n\nDirectly interpretable\nDoes not require proportional hazards\nWorks well when survival curves cross\n\n\n\n\n\nShow R code\nlibrary(ggplot2)\n\n# Parameters\ntau &lt;- 5\nrate &lt;- 0.2\ntmax &lt;- 10\n\n\n# Example survival curve\n# S(t) = exp(-rate * t)\n\nsurv_df &lt;- data.frame(time = seq(0, tmax, by = 0.01))\nsurv_df$S &lt;- exp(-rate * surv_df$time)\n\n# Area under curve up to tau (RMST region)\nsurv_df_shade &lt;- subset(surv_df, time &lt;= tau)\n\n\n# Plot\nggplot(surv_df, aes(x = time, y = S)) +\n  geom_area(\n    data = surv_df_shade,\n    aes(x = time, y = S),\n    fill = \"skyblue\",\n    alpha = 0.35\n  ) +\n  geom_line(\n    linewidth = 1.2,\n    colour = \"blue\"\n  ) +\n  geom_vline(\n    xintercept = tau,\n    linetype = \"dashed\",\n    colour = \"red\",\n    linewidth = 0.9\n  ) +\n  annotate(\n    \"text\",\n    x = tau + 0.15,\n    y = 0.5,\n    label = paste0(\"Tau = \", tau),\n    colour = \"red\",\n    size = 5,\n    hjust = 0\n  ) +\n  labs(\n    x = \"Time\",\n    y = \"Survival Probability\"\n  ) +\n  coord_cartesian(xlim = c(0, tmax), ylim = c(0, 1)) +\n  theme_minimal(base_size = 14)",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  },
  {
    "objectID": "lecture-01-intro-km-rmst.html#adjusted-rmst-regression-in-kidney-transplant-patients",
    "href": "lecture-01-intro-km-rmst.html#adjusted-rmst-regression-in-kidney-transplant-patients",
    "title": "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST",
    "section": "8 Adjusted RMST regression in Kidney Transplant Patients",
    "text": "8 Adjusted RMST regression in Kidney Transplant Patients\nWe aim to estimate the restricted mean survival time (RMST) up to \\(\\tau = 36\\) months after kidney transplantation, and to compare outcomes between donor types while adjusting for important clinical factors.\nOutcome\n- Time to graft failure (months since transplantation)\nEvent Indicator\n- Graft failure status - 1 = graft failure occurred\n- 0 = censored (no failure by end of follow-up)\nMain Exposure\n- Donor type - Living donor\n- Deceased donor\nCovariates (Adjusted For)\nTo reduce confounding, we adjust for:\n- Donor age (years)\n- Recipient gender (male / female)\n- Baseline eGFR at transplant (kidney function at time of surgery)\nInterpretation Goal\nAfter adjustment, the RMST contrast represents:\n\nThe average difference in graft-survival time up to \\(36\\) months between living and deceased donor transplants,\namong patients with similar donor age, recipient gender, and baseline eGFR.\n\n\n\nShow R code\nlibrary(survival)\nlibrary(survRM2)\nlibrary(survminer)\nlibrary(dplyr)\n\n\n# -------------------- Simulate the dataset\n\nset.seed(2025)\nn &lt;- 1000\n\n# Donor type\ndonor_type &lt;- sample(c(\"Living\", \"Deceased\"), size = n, replace = TRUE)\n\n# Donor age (older for deceased donors)\ndonor_age &lt;- ifelse(donor_type == \"Living\",\n                    rnorm(n, mean = 45, sd = 10),\n                    rnorm(n, mean = 60, sd = 10))\ndonor_age &lt;- round(pmax(donor_age, 18))\n\n# Recipient sex\nrecipient_sex &lt;- sample(c(\"Male\", \"Female\"), size = n, replace = TRUE)\n\n# eGFR at transplant\negfr_at_tx &lt;- round(runif(n, min = 5, max = 60), 1)\n\n# Simulated survival times (longer for living donors)\ntime &lt;- ifelse(donor_type == \"Living\",\n               rexp(n, rate = 0.05),  # mean ~20\n               rexp(n, rate = 0.1))   # mean ~10\n\n# Censoring\ncensoring_time &lt;- rexp(n, rate = 0.05)\n#observed_time &lt;- pmin(time, censoring_time)\nobserved_time &lt;- pmax(pmin(time, censoring_time), 0.01)\nstatus &lt;- as.integer(time &lt;= censoring_time)\n\n# Create dataset\ndf &lt;- data.frame(\n  id = 1:n,\n  time = round(observed_time, 1),\n  status = status,\n  donor_type = donor_type,\n  donor_age = donor_age,\n  recipient_sex = recipient_sex,\n  egfr_at_tx = egfr_at_tx\n)\n\n# Encode donor_type as binary: 1 = Living, 0 = Deceased\ndf$donor_type_bin &lt;- ifelse(df$donor_type == \"Living\", 1, 0)\n\n\n#----------------- Fit RMST Regression (with covariates)\n\n# Set truncation time œÑ (e.g., 36 months)\ntau &lt;- 36\n\ndf$recipient_sex &lt;- as.factor(df$recipient_sex)\ndf$donor_type_bin &lt;- ifelse(df$donor_type == \"Living\", 1, 0)\ndf$time[df$time == 0] &lt;- 0.01\ncovariates &lt;- model.matrix(~ donor_age + recipient_sex + egfr_at_tx, data = df)[, -1]\n\n\n# Fit RMST regression model\nrmst_model &lt;- rmst2(time = df$time,\n                    status = df$status,\n                    arm = df$donor_type_bin,\n                    tau = 36,\n                    covariates = covariates\n                    )\n\nrmst_model\n\n\n\nThe truncation time: tau = 36  was specified. \n\nSummary of between-group contrast (adjusted for the covariates) \n                      Est. lower .95 upper .95 p\nRMST (arm=1)-(arm=0) 6.298     3.914     8.681 0\nRMST (arm=1)/(arm=0) 1.690     1.391     2.054 0\nRMTL (arm=1)/(arm=0) 0.766     0.691     0.850 0\n\n\nModel summary (difference of RMST) \n                    coef se(coef)      z     p lower .95 upper .95\nintercept          7.102    3.909  1.817 0.069    -0.559    14.763\narm                6.298    1.216  5.179 0.000     3.914     8.681\ndonor_age          0.016    0.055  0.295 0.768    -0.092     0.124\nrecipient_sexMale -0.748    1.230 -0.608 0.543    -3.158     1.663\negfr_at_tx         0.047    0.041  1.150 0.250    -0.033     0.127\n\n\nModel summary (ratio of RMST) \n                    coef se(coef)      z     p exp(coef) lower .95 upper .95\nintercept          2.042    0.325  6.280 0.000     7.705     4.074    14.571\narm                0.525    0.099  5.281 0.000     1.690     1.391     2.054\ndonor_age          0.001    0.005  0.310 0.756     1.001     0.993     1.010\nrecipient_sexMale -0.063    0.102 -0.617 0.537     0.939     0.769     1.146\negfr_at_tx         0.004    0.003  1.159 0.246     1.004     0.997     1.011\n\n\nModel summary (ratio of time-lost) \n                    coef se(coef)      z     p exp(coef) lower .95 upper .95\nintercept          3.375    0.163 20.686 0.000    29.224    21.226    40.237\narm               -0.266    0.053 -5.022 0.000     0.766     0.691     0.850\ndonor_age         -0.001    0.002 -0.288 0.773     0.999     0.995     1.004\nrecipient_sexMale  0.031    0.051  0.603 0.546     1.032     0.933     1.141\negfr_at_tx        -0.002    0.002 -1.144 0.252     0.998     0.995     1.001\n\n\n\n\n\n\n\n\nInterpretation (RMST difference)\n\n\n\nRMST (Living donor - Deceased donor) = 6.30 months95% CI: 3.91 to 8.68, p &lt; 0.001 Interpretation: On average, recipients of living donor kidneys survive 6.3 more months event-free (up to 36 months) than those with deceased donors, after adjusting for age, sex, and eGFR at transplant.\n\n\n\n\n\n\n\n\nInterpretation (RMST ratio)\n\n\n\nRMST ratio = 1.69 (Living vs Deceased) 95% CI: 1.39 to 2.05, p &lt; 0.001 Over the 36-month period, recipients of living donor kidneys have 69% longer average event-free survival time than recipients of deceased donor kidneys, after adjustment.\n\n\n\n\n\n\n\n\nInterpretation (Covariate coefficients)\n\n\n\nNone of the covariates were significant in our simulated data but if for an example egfr was significant then the interpretation would be:\nEach unit increase in eGFR at the time of transplant is associated with an additional 0.047(coefficient in the model ) months (‚âà3 days) of average event-free survival time over 36 months, adjusting for donor type, donor age, and recipient sex.\n\n\n\nThink about the following before moving on:\n\nWhy do we need to choose a truncation time \\(œÑ\\)?\nWhat happens if œÑ is too short or too long?\nWhen would RMST be preferable to a Cox model?",
    "crumbs": [
      "Lectures",
      "Lecture 1: Introduction, Kaplan‚ÄìMeier and RMST"
    ]
  }
]